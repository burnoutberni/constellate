{
    "openapi": "3.0.0",
    "info": {
        "title": "Stellar Calendar API",
        "version": "1.0.0",
        "description": "Federated event management platform implementing ActivityPub protocol",
        "license": {
            "name": "AGPL-3.0"
        }
    },
    "servers": [
        {
            "url": "http://localhost:3000",
            "description": "Development server"
        }
    ],
    "tags": [
        {
            "name": "Events",
            "description": "Event management"
        },
        {
            "name": "Attendance",
            "description": "Event attendance"
        },
        {
            "name": "Likes",
            "description": "Event likes"
        },
        {
            "name": "Comments",
            "description": "Event comments"
        },
        {
            "name": "Profile",
            "description": "User profiles"
        },
        {
            "name": "Search",
            "description": "Search functionality"
        },
        {
            "name": "User Search",
            "description": "WebFinger user search"
        },
        {
            "name": "Moderation",
            "description": "Blocking and reporting"
        },
        {
            "name": "Calendar",
            "description": "iCal exports"
        },
        {
            "name": "Realtime",
            "description": "Live updates"
        }
    ],
    "components": {
        "securitySchemes": {
            "cookieAuth": {
                "type": "apiKey",
                "in": "cookie",
                "name": "better-auth.session_token"
            }
        },
        "schemas": {
            "Error": {
                "type": "object",
                "properties": {
                    "error": {
                        "type": "string"
                    }
                }
            },
            "User": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "username": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string",
                        "nullable": true
                    },
                    "displayColor": {
                        "type": "string",
                        "nullable": true
                    },
                    "profileImage": {
                        "type": "string",
                        "nullable": true
                    }
                }
            },
            "Event": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "title": {
                        "type": "string"
                    },
                    "summary": {
                        "type": "string",
                        "nullable": true
                    },
                    "location": {
                        "type": "string",
                        "nullable": true
                    },
                    "startTime": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "endTime": {
                        "type": "string",
                        "format": "date-time",
                        "nullable": true
                    },
                    "user": {
                        "$ref": "#/components/schemas/User"
                    }
                }
            },
            "EventInput": {
                "type": "object",
                "required": [
                    "title",
                    "startTime"
                ],
                "properties": {
                    "title": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 200
                    },
                    "summary": {
                        "type": "string"
                    },
                    "location": {
                        "type": "string"
                    },
                    "headerImage": {
                        "type": "string",
                        "format": "uri"
                    },
                    "url": {
                        "type": "string",
                        "format": "uri"
                    },
                    "startTime": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "endTime": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "eventStatus": {
                        "type": "string",
                        "enum": [
                            "EventScheduled",
                            "EventCancelled",
                            "EventPostponed"
                        ]
                    },
                    "eventAttendanceMode": {
                        "type": "string",
                        "enum": [
                            "OfflineEventAttendanceMode",
                            "OnlineEventAttendanceMode",
                            "MixedEventAttendanceMode"
                        ]
                    },
                    "maximumAttendeeCapacity": {
                        "type": "integer",
                        "minimum": 1
                    }
                }
            },
            "AttendanceInput": {
                "type": "object",
                "required": [
                    "status"
                ],
                "properties": {
                    "status": {
                        "type": "string",
                        "enum": [
                            "attending",
                            "maybe",
                            "not_attending"
                        ]
                    }
                }
            },
            "CommentInput": {
                "type": "object",
                "required": [
                    "content"
                ],
                "properties": {
                    "content": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 5000
                    }
                }
            },
            "ProfileUpdate": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "maxLength": 100
                    },
                    "bio": {
                        "type": "string",
                        "maxLength": 500
                    },
                    "profileImage": {
                        "type": "string",
                        "format": "uri"
                    },
                    "headerImage": {
                        "type": "string",
                        "format": "uri"
                    },
                    "displayColor": {
                        "type": "string",
                        "pattern": "^#[0-9A-Fa-f]{6}$"
                    }
                }
            },
            "BlockUserInput": {
                "type": "object",
                "required": [
                    "username"
                ],
                "properties": {
                    "username": {
                        "type": "string"
                    }
                }
            },
            "BlockDomainInput": {
                "type": "object",
                "required": [
                    "domain"
                ],
                "properties": {
                    "domain": {
                        "type": "string"
                    }
                }
            },
            "ReportInput": {
                "type": "object",
                "required": [
                    "targetType",
                    "targetId",
                    "reason"
                ],
                "properties": {
                    "targetType": {
                        "type": "string",
                        "enum": [
                            "user",
                            "event",
                            "comment"
                        ]
                    },
                    "targetId": {
                        "type": "string"
                    },
                    "reason": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 1000
                    }
                }
            }
        }
    },
    "security": [
        {
            "cookieAuth": []
        }
    ],
    "paths": {
        "/api/events": {
            "post": {
                "tags": [
                    "Events"
                ],
                "summary": "Create a new event",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/EventInput"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Event created",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Event"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "400": {
                        "description": "Validation error"
                    }
                }
            },
            "get": {
                "tags": [
                    "Events"
                ],
                "summary": "List events",
                "parameters": [
                    {
                        "name": "page",
                        "in": "query",
                        "schema": {
                            "type": "integer",
                            "default": 1
                        }
                    },
                    {
                        "name": "limit",
                        "in": "query",
                        "schema": {
                            "type": "integer",
                            "default": 20
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of events",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "events": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/Event"
                                            }
                                        },
                                        "pagination": {
                                            "type": "object",
                                            "properties": {
                                                "page": {
                                                    "type": "integer"
                                                },
                                                "limit": {
                                                    "type": "integer"
                                                },
                                                "total": {
                                                    "type": "integer"
                                                },
                                                "pages": {
                                                    "type": "integer"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/events/{id}": {
            "get": {
                "tags": [
                    "Events"
                ],
                "summary": "Get event by ID",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Event details",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Event"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Event not found"
                    }
                }
            },
            "put": {
                "tags": [
                    "Events"
                ],
                "summary": "Update event",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/EventInput"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Event updated",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Event"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "404": {
                        "description": "Event not found"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Events"
                ],
                "summary": "Delete event",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Event deleted"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "404": {
                        "description": "Event not found"
                    }
                }
            }
        },
        "/api/events/by-user/{username}/{eventId}": {
            "get": {
                "tags": [
                    "Events"
                ],
                "summary": "Get event by username and event ID",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "eventId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Event details",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Event"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Event not found"
                    }
                }
            }
        },
        "/api/events/{id}/attend": {
            "post": {
                "tags": [
                    "Attendance"
                ],
                "summary": "Set attendance status",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/AttendanceInput"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Attendance set"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Attendance"
                ],
                "summary": "Remove attendance",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Attendance removed"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/events/{id}/attendees": {
            "get": {
                "tags": [
                    "Attendance"
                ],
                "summary": "Get event attendees",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of attendees",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "status": {
                                                "type": "string"
                                            },
                                            "user": {
                                                "$ref": "#/components/schemas/User"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/events/{id}/like": {
            "post": {
                "tags": [
                    "Likes"
                ],
                "summary": "Like an event",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Event liked"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Likes"
                ],
                "summary": "Unlike an event",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Event unliked"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/events/{id}/likes": {
            "get": {
                "tags": [
                    "Likes"
                ],
                "summary": "Get event likes",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of users who liked the event",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/User"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/events/{id}/comments": {
            "post": {
                "tags": [
                    "Comments"
                ],
                "summary": "Add comment to event",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CommentInput"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Comment created"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            },
            "get": {
                "tags": [
                    "Comments"
                ],
                "summary": "Get event comments",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of comments",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "id": {
                                                "type": "string"
                                            },
                                            "content": {
                                                "type": "string"
                                            },
                                            "author": {
                                                "$ref": "#/components/schemas/User"
                                            },
                                            "createdAt": {
                                                "type": "string",
                                                "format": "date-time"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/comments/{commentId}": {
            "delete": {
                "tags": [
                    "Comments"
                ],
                "summary": "Delete comment",
                "parameters": [
                    {
                        "name": "commentId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Comment deleted"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    }
                }
            }
        },
        "/api/profile": {
            "put": {
                "tags": [
                    "Profile"
                ],
                "summary": "Update own profile",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ProfileUpdate"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Profile updated"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/users/{username}/profile": {
            "get": {
                "tags": [
                    "Profile"
                ],
                "summary": "Get user profile",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User profile",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "id": {
                                            "type": "string"
                                        },
                                        "username": {
                                            "type": "string"
                                        },
                                        "name": {
                                            "type": "string",
                                            "nullable": true
                                        },
                                        "bio": {
                                            "type": "string",
                                            "nullable": true
                                        },
                                        "profileImage": {
                                            "type": "string",
                                            "nullable": true
                                        },
                                        "displayColor": {
                                            "type": "string",
                                            "nullable": true
                                        },
                                        "_count": {
                                            "type": "object",
                                            "properties": {
                                                "followers": {
                                                    "type": "integer"
                                                },
                                                "following": {
                                                    "type": "integer"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found"
                    }
                }
            }
        },
        "/api/users/{username}/follow": {
            "post": {
                "tags": [
                    "Profile"
                ],
                "summary": "Follow a user",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User followed"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Profile"
                ],
                "summary": "Unfollow a user",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User unfollowed"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/users/{username}/follow-status": {
            "get": {
                "tags": [
                    "Profile"
                ],
                "summary": "Get follow status for a user",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Follow status",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "isFollowing": {
                                            "type": "boolean"
                                        },
                                        "isFollowedBy": {
                                            "type": "boolean"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/search": {
            "get": {
                "tags": [
                    "Search"
                ],
                "summary": "Search events",
                "parameters": [
                    {
                        "name": "q",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "page",
                        "in": "query",
                        "schema": {
                            "type": "integer",
                            "default": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Search results",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Event"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/search/upcoming": {
            "get": {
                "tags": [
                    "Search"
                ],
                "summary": "Get upcoming events",
                "responses": {
                    "200": {
                        "description": "Upcoming events",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Event"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/search/popular": {
            "get": {
                "tags": [
                    "Search"
                ],
                "summary": "Get popular events",
                "responses": {
                    "200": {
                        "description": "Popular events",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Event"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/user-search": {
            "get": {
                "tags": [
                    "User Search"
                ],
                "summary": "Search for users (WebFinger)",
                "parameters": [
                    {
                        "name": "query",
                        "in": "query",
                        "required": true,
                        "description": "Username or @user@domain format",
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Search results",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/User"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/user-search/resolve": {
            "post": {
                "tags": [
                    "User Search"
                ],
                "summary": "Resolve remote user",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": [
                                    "query"
                                ],
                                "properties": {
                                    "query": {
                                        "type": "string",
                                        "description": "@user@domain format"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "User resolved"
                    }
                }
            }
        },
        "/api/user-search/profile/{username}": {
            "get": {
                "tags": [
                    "User Search"
                ],
                "summary": "Get user profile by username",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User profile",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/User"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/moderation/block/user": {
            "post": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Block a user",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/BlockUserInput"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "User blocked"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/moderation/block/user/{username}": {
            "delete": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Unblock a user",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User unblocked"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/moderation/block/users": {
            "get": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Get blocked users",
                "responses": {
                    "200": {
                        "description": "List of blocked users",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/moderation/block/domain": {
            "post": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Block a domain",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/BlockDomainInput"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Domain blocked"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/moderation/block/domain/{domain}": {
            "delete": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Unblock a domain",
                "parameters": [
                    {
                        "name": "domain",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Domain unblocked"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/moderation/block/domains": {
            "get": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Get blocked domains",
                "responses": {
                    "200": {
                        "description": "List of blocked domains",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/moderation/block/check/{username}": {
            "get": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Check if user is blocked",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Block status",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "isBlocked": {
                                            "type": "boolean"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/moderation/report": {
            "post": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Report content or user",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ReportInput"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Report created"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/moderation/reports": {
            "get": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Get reports (admin only)",
                "responses": {
                    "200": {
                        "description": "List of reports",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "id": {
                                                "type": "string"
                                            },
                                            "targetType": {
                                                "type": "string"
                                            },
                                            "targetId": {
                                                "type": "string"
                                            },
                                            "reason": {
                                                "type": "string"
                                            },
                                            "status": {
                                                "type": "string"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/moderation/reports/{id}": {
            "put": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Update report status (admin only)",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": [
                                    "status"
                                ],
                                "properties": {
                                    "status": {
                                        "type": "string",
                                        "enum": [
                                            "pending",
                                            "resolved",
                                            "dismissed"
                                        ]
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Report updated"
                    }
                }
            }
        },
        "/api/calendar/{id}/export.ics": {
            "get": {
                "tags": [
                    "Calendar"
                ],
                "summary": "Export single event as iCal",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "iCal file",
                        "content": {
                            "text/calendar": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/calendar/user/{username}/export.ics": {
            "get": {
                "tags": [
                    "Calendar"
                ],
                "summary": "Export user's events as iCal",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "iCal file",
                        "content": {
                            "text/calendar": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/calendar/feed.ics": {
            "get": {
                "tags": [
                    "Calendar"
                ],
                "summary": "Export own events as iCal feed",
                "responses": {
                    "200": {
                        "description": "iCal file",
                        "content": {
                            "text/calendar": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/realtime/stream": {
            "get": {
                "tags": [
                    "Realtime"
                ],
                "summary": "Server-sent events stream",
                "description": "Subscribe to real-time updates via Server-Sent Events (SSE). Events include:\n- Event updates: `event:created`, `event:updated`, `event:deleted`\n- Attendance: `attendance:added`, `attendance:updated`, `attendance:removed`\n- Likes: `like:added`, `like:removed`\n- Comments: `comment:added`, `comment:deleted`\n- Follows: `follow:added`, `follow:removed`, `follow:accepted`, `follow:pending`, `follow:rejected`\n- Followers: `follower:added`, `follower:removed`\n- Profile: `profile:updated`\n\nAll events include a `type` field and a `data` object with event-specific information. The stream sends a `connected` event on initial connection and periodic `heartbeat` events to keep the connection alive.",
                "responses": {
                    "200": {
                        "description": "SSE stream",
                        "content": {
                            "text/event-stream": {
                                "schema": {
                                    "type": "string",
                                    "description": "Server-Sent Events stream. Each event has an `event` field (event type) and a `data` field (JSON string with event data)."
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}