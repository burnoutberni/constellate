{
    "openapi": "3.0.0",
    "info": {
        "title": "Constellate API",
        "version": "1.0.0",
        "description": "Federated event management platform implementing ActivityPub protocol",
        "license": {
            "name": "AGPL-3.0"
        }
    },
    "servers": [
        {
            "url": "http://localhost:3000",
            "description": "Development server"
        }
    ],
    "tags": [
        {
            "name": "Events",
            "description": "Event management"
        },
        {
            "name": "Event Templates",
            "description": "Save and reuse event configurations"
        },
        {
            "name": "Attendance",
            "description": "Event attendance"
        },
        {
            "name": "Likes",
            "description": "Event likes"
        },
        {
            "name": "Comments",
            "description": "Event comments"
        },
        {
            "name": "Profile",
            "description": "User profiles"
        },
        {
            "name": "Search",
            "description": "Search functionality"
        },
        {
            "name": "User Search",
            "description": "WebFinger user search"
        },
        {
            "name": "Moderation",
            "description": "Blocking and reporting"
        },
        {
            "name": "Calendar",
            "description": "iCal exports"
        },
        {
            "name": "Realtime",
            "description": "Live updates"
        },
        {
            "name": "Admin",
            "description": "Administrative operations (admin only)"
        },
        {
            "name": "Setup",
            "description": "Initial instance setup and onboarding"
        }
    ],
    "components": {
        "securitySchemes": {
            "cookieAuth": {
                "type": "apiKey",
                "in": "cookie",
                "name": "better-auth.session_token",
                "description": "Session-based authentication using cookies"
            },
            "apiKeyAuth": {
                "type": "http",
                "scheme": "bearer",
                "bearerFormat": "API Key",
                "description": "API key authentication. Use format: Bearer sk_live_..."
            }
        },
        "schemas": {
            "Error": {
                "type": "object",
                "properties": {
                    "error": {
                        "type": "string"
                    }
                }
            },
            "User": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "username": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string",
                        "nullable": true
                    },
                    "displayColor": {
                        "type": "string",
                        "nullable": true
                    },
                    "profileImage": {
                        "type": "string",
                        "nullable": true
                    }
                }
            },
            "Event": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "title": {
                        "type": "string"
                    },
                    "summary": {
                        "type": "string",
                        "nullable": true
                    },
                    "location": {
                        "type": "string",
                        "nullable": true
                    },
                    "startTime": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "endTime": {
                        "type": "string",
                        "format": "date-time",
                        "nullable": true
                    },
                    "user": {
                        "$ref": "#/components/schemas/User"
                    },
                    "visibility": {
                        "type": "string",
                        "enum": [
                            "PUBLIC",
                            "FOLLOWERS",
                            "PRIVATE",
                            "UNLISTED"
                        ]
                    }
                }
            },
            "EventInput": {
                "type": "object",
                "required": [
                    "title",
                    "startTime"
                ],
                "properties": {
                    "title": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 200
                    },
                    "summary": {
                        "type": "string"
                    },
                    "location": {
                        "type": "string"
                    },
                    "headerImage": {
                        "type": "string",
                        "format": "uri"
                    },
                    "url": {
                        "type": "string",
                        "format": "uri"
                    },
                    "startTime": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "endTime": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "eventStatus": {
                        "type": "string",
                        "enum": [
                            "EventScheduled",
                            "EventCancelled",
                            "EventPostponed"
                        ]
                    },
                    "eventAttendanceMode": {
                        "type": "string",
                        "enum": [
                            "OfflineEventAttendanceMode",
                            "OnlineEventAttendanceMode",
                            "MixedEventAttendanceMode"
                        ]
                    },
                    "maximumAttendeeCapacity": {
                        "type": "integer",
                        "minimum": 1
                    },
                    "visibility": {
                        "type": "string",
                        "enum": [
                            "PUBLIC",
                            "FOLLOWERS",
                            "PRIVATE",
                            "UNLISTED"
                        ]
                    }
                }
            },
            "EventTemplateData": {
                "type": "object",
                "required": [
                    "title"
                ],
                "properties": {
                    "title": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 200
                    },
                    "summary": {
                        "type": "string"
                    },
                    "location": {
                        "type": "string"
                    },
                    "headerImage": {
                        "type": "string",
                        "format": "uri"
                    },
                    "url": {
                        "type": "string",
                        "format": "uri"
                    },
                    "startTime": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "endTime": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "duration": {
                        "type": "string"
                    },
                    "eventStatus": {
                        "type": "string",
                        "enum": [
                            "EventScheduled",
                            "EventCancelled",
                            "EventPostponed"
                        ]
                    },
                    "eventAttendanceMode": {
                        "type": "string",
                        "enum": [
                            "OfflineEventAttendanceMode",
                            "OnlineEventAttendanceMode",
                            "MixedEventAttendanceMode"
                        ]
                    },
                    "maximumAttendeeCapacity": {
                        "type": "integer",
                        "minimum": 1
                    }
                }
            },
            "EventTemplateDataUpdate": {
                "type": "object",
                "properties": {
                    "title": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 200
                    },
                    "summary": {
                        "type": "string"
                    },
                    "location": {
                        "type": "string"
                    },
                    "headerImage": {
                        "type": "string",
                        "format": "uri"
                    },
                    "url": {
                        "type": "string",
                        "format": "uri"
                    },
                    "startTime": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "endTime": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "duration": {
                        "type": "string"
                    },
                    "eventStatus": {
                        "type": "string",
                        "enum": [
                            "EventScheduled",
                            "EventCancelled",
                            "EventPostponed"
                        ]
                    },
                    "eventAttendanceMode": {
                        "type": "string",
                        "enum": [
                            "OfflineEventAttendanceMode",
                            "OnlineEventAttendanceMode",
                            "MixedEventAttendanceMode"
                        ]
                    },
                    "maximumAttendeeCapacity": {
                        "type": "integer",
                        "minimum": 1
                    }
                }
            },
            "EventTemplateInput": {
                "type": "object",
                "required": [
                    "name",
                    "data"
                ],
                "properties": {
                    "name": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 120
                    },
                    "description": {
                        "type": "string",
                        "maxLength": 500
                    },
                    "data": {
                        "$ref": "#/components/schemas/EventTemplateData"
                    }
                }
            },
            "EventTemplate": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string"
                    },
                    "description": {
                        "type": "string",
                        "nullable": true
                    },
                    "data": {
                        "$ref": "#/components/schemas/EventTemplateData"
                    },
                    "createdAt": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "updatedAt": {
                        "type": "string",
                        "format": "date-time"
                    }
                }
            },
            "EventTemplateUpdate": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 120
                    },
                    "description": {
                        "type": "string",
                        "maxLength": 500
                    },
                    "data": {
                        "$ref": "#/components/schemas/EventTemplateDataUpdate"
                    }
                }
            },
            "EventTemplateList": {
                "type": "object",
                "properties": {
                    "templates": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/EventTemplate"
                        }
                    }
                }
            },
            "AttendanceInput": {
                "type": "object",
                "required": [
                    "status"
                ],
                "properties": {
                    "status": {
                        "type": "string",
                        "enum": [
                            "attending",
                            "maybe",
                            "not_attending"
                        ]
                    }
                }
            },
            "CommentInput": {
                "type": "object",
                "required": [
                    "content"
                ],
                "properties": {
                    "content": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 5000
                    }
                }
            },
            "ProfileUpdate": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "maxLength": 100
                    },
                    "bio": {
                        "type": "string",
                        "maxLength": 500
                    },
                    "profileImage": {
                        "type": "string",
                        "format": "uri"
                    },
                    "headerImage": {
                        "type": "string",
                        "format": "uri"
                    },
                    "displayColor": {
                        "type": "string",
                        "pattern": "^#[0-9A-Fa-f]{6}$"
                    }
                }
            },
            "BlockUserInput": {
                "type": "object",
                "required": [
                    "username"
                ],
                "properties": {
                    "username": {
                        "type": "string"
                    }
                }
            },
            "BlockDomainInput": {
                "type": "object",
                "required": [
                    "domain"
                ],
                "properties": {
                    "domain": {
                        "type": "string"
                    }
                }
            },
            "ReportInput": {
                "type": "object",
                "required": [
                    "targetType",
                    "targetId",
                    "reason"
                ],
                "properties": {
                    "targetType": {
                        "type": "string",
                        "enum": [
                            "user",
                            "event",
                            "comment"
                        ]
                    },
                    "targetId": {
                        "type": "string"
                    },
                    "reason": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 1000
                    }
                }
            },
            "AdminUser": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "username": {
                        "type": "string"
                    },
                    "email": {
                        "type": "string",
                        "nullable": true
                    },
                    "name": {
                        "type": "string",
                        "nullable": true
                    },
                    "isAdmin": {
                        "type": "boolean"
                    },
                    "isBot": {
                        "type": "boolean"
                    },
                    "isRemote": {
                        "type": "boolean"
                    },
                    "displayColor": {
                        "type": "string",
                        "nullable": true
                    },
                    "bio": {
                        "type": "string",
                        "nullable": true
                    },
                    "createdAt": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "updatedAt": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "_count": {
                        "type": "object",
                        "properties": {
                            "events": {
                                "type": "integer"
                            },
                            "followers": {
                                "type": "integer"
                            },
                            "following": {
                                "type": "integer"
                            },
                            "apiKeys": {
                                "type": "integer"
                            }
                        }
                    }
                }
            },
            "CreateUserInput": {
                "type": "object",
                "required": [
                    "username"
                ],
                "properties": {
                    "username": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 50
                    },
                    "email": {
                        "type": "string",
                        "format": "email"
                    },
                    "name": {
                        "type": "string"
                    },
                    "isAdmin": {
                        "type": "boolean",
                        "default": false
                    },
                    "isBot": {
                        "type": "boolean",
                        "default": false
                    },
                    "displayColor": {
                        "type": "string"
                    },
                    "bio": {
                        "type": "string"
                    },
                    "password": {
                        "type": "string",
                        "minLength": 8,
                        "description": "Required for non-bot users"
                    }
                }
            },
            "UpdateUserInput": {
                "type": "object",
                "properties": {
                    "username": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 50
                    },
                    "email": {
                        "type": "string",
                        "format": "email"
                    },
                    "name": {
                        "type": "string"
                    },
                    "isAdmin": {
                        "type": "boolean"
                    },
                    "isBot": {
                        "type": "boolean"
                    },
                    "displayColor": {
                        "type": "string"
                    },
                    "bio": {
                        "type": "string"
                    }
                }
            },
            "ApiKey": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string"
                    },
                    "description": {
                        "type": "string",
                        "nullable": true
                    },
                    "prefix": {
                        "type": "string",
                        "description": "First 12 characters of the key for display"
                    },
                    "userId": {
                        "type": "string"
                    },
                    "user": {
                        "type": "object",
                        "properties": {
                            "id": {
                                "type": "string"
                            },
                            "username": {
                                "type": "string"
                            },
                            "name": {
                                "type": "string",
                                "nullable": true
                            }
                        }
                    },
                    "createdAt": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "updatedAt": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "lastUsedAt": {
                        "type": "string",
                        "format": "date-time",
                        "nullable": true
                    }
                }
            },
            "ApiKeyCreateResponse": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string"
                    },
                    "description": {
                        "type": "string",
                        "nullable": true
                    },
                    "key": {
                        "type": "string",
                        "description": "Full API key (only returned on creation)"
                    },
                    "prefix": {
                        "type": "string"
                    },
                    "userId": {
                        "type": "string"
                    },
                    "user": {
                        "type": "object",
                        "properties": {
                            "id": {
                                "type": "string"
                            },
                            "username": {
                                "type": "string"
                            },
                            "name": {
                                "type": "string",
                                "nullable": true
                            }
                        }
                    },
                    "createdAt": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "warning": {
                        "type": "string",
                        "description": "Warning message about saving the key"
                    }
                }
            },
            "CreateApiKeyInput": {
                "type": "object",
                "required": [
                    "userId",
                    "name"
                ],
                "properties": {
                    "userId": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string",
                        "minLength": 1,
                        "maxLength": 100
                    },
                    "description": {
                        "type": "string",
                        "maxLength": 500
                    }
                }
            },
            "UserListResponse": {
                "type": "object",
                "properties": {
                    "users": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/AdminUser"
                        }
                    },
                    "pagination": {
                        "type": "object",
                        "properties": {
                            "page": {
                                "type": "integer"
                            },
                            "limit": {
                                "type": "integer"
                            },
                            "total": {
                                "type": "integer"
                            },
                            "pages": {
                                "type": "integer"
                            }
                        }
                    }
                }
            },
            "ApiKeyListResponse": {
                "type": "object",
                "properties": {
                    "apiKeys": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/ApiKey"
                        }
                    }
                }
            }
        }
    },
    "security": [
        {
            "cookieAuth": []
        },
        {
            "apiKeyAuth": []
        }
    ],
    "paths": {
        "/api/events": {
            "post": {
                "tags": [
                    "Events"
                ],
                "summary": "Create a new event",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/EventInput"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Event created",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Event"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "400": {
                        "description": "Validation error"
                    }
                }
            },
            "get": {
                "tags": [
                    "Events"
                ],
                "summary": "List events",
                "parameters": [
                    {
                        "name": "page",
                        "in": "query",
                        "schema": {
                            "type": "integer",
                            "default": 1
                        }
                    },
                    {
                        "name": "limit",
                        "in": "query",
                        "schema": {
                            "type": "integer",
                            "default": 20
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of events",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "events": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/Event"
                                            }
                                        },
                                        "pagination": {
                                            "type": "object",
                                            "properties": {
                                                "page": {
                                                    "type": "integer"
                                                },
                                                "limit": {
                                                    "type": "integer"
                                                },
                                                "total": {
                                                    "type": "integer"
                                                },
                                                "pages": {
                                                    "type": "integer"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/event-templates": {
            "get": {
                "tags": [
                    "Event Templates"
                ],
                "summary": "List event templates for the authenticated user",
                "responses": {
                    "200": {
                        "description": "List of event templates",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/EventTemplateList"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            },
            "post": {
                "tags": [
                    "Event Templates"
                ],
                "summary": "Create a new event template",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/EventTemplateInput"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Template created",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/EventTemplate"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "409": {
                        "description": "Duplicate template name"
                    }
                }
            }
        },
        "/api/event-templates/{id}": {
            "get": {
                "tags": [
                    "Event Templates"
                ],
                "summary": "Get an event template by ID",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Template details",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/EventTemplate"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "Template not found"
                    }
                }
            },
            "put": {
                "tags": [
                    "Event Templates"
                ],
                "summary": "Update an event template",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/EventTemplateUpdate"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Updated template",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/EventTemplate"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "Template not found"
                    },
                    "409": {
                        "description": "Duplicate template name"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Event Templates"
                ],
                "summary": "Delete an event template",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Deletion result",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "Template not found"
                    }
                }
            }
        },
        "/api/events/{id}": {
            "get": {
                "tags": [
                    "Events"
                ],
                "summary": "Get event by ID",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Event details",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Event"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Event not found"
                    }
                }
            },
            "put": {
                "tags": [
                    "Events"
                ],
                "summary": "Update event",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/EventInput"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Event updated",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Event"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "404": {
                        "description": "Event not found"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Events"
                ],
                "summary": "Delete event",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Event deleted"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    },
                    "404": {
                        "description": "Event not found"
                    }
                }
            }
        },
        "/api/events/by-user/{username}/{eventId}": {
            "get": {
                "tags": [
                    "Events"
                ],
                "summary": "Get event by username and event ID",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "eventId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Event details",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Event"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Event not found"
                    }
                }
            }
        },
        "/api/events/{id}/attend": {
            "post": {
                "tags": [
                    "Attendance"
                ],
                "summary": "Set attendance status",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/AttendanceInput"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Attendance set"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Attendance"
                ],
                "summary": "Remove attendance",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Attendance removed"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/events/{id}/attendees": {
            "get": {
                "tags": [
                    "Attendance"
                ],
                "summary": "Get event attendees",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of attendees",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "status": {
                                                "type": "string"
                                            },
                                            "user": {
                                                "$ref": "#/components/schemas/User"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/events/{id}/like": {
            "post": {
                "tags": [
                    "Likes"
                ],
                "summary": "Like an event",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Event liked"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Likes"
                ],
                "summary": "Unlike an event",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Event unliked"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/events/{id}/likes": {
            "get": {
                "tags": [
                    "Likes"
                ],
                "summary": "Get event likes",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of users who liked the event",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/User"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/events/{id}/comments": {
            "post": {
                "tags": [
                    "Comments"
                ],
                "summary": "Add comment to event",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CommentInput"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Comment created"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            },
            "get": {
                "tags": [
                    "Comments"
                ],
                "summary": "Get event comments",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of comments",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "id": {
                                                "type": "string"
                                            },
                                            "content": {
                                                "type": "string"
                                            },
                                            "author": {
                                                "$ref": "#/components/schemas/User"
                                            },
                                            "createdAt": {
                                                "type": "string",
                                                "format": "date-time"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/comments/{commentId}": {
            "delete": {
                "tags": [
                    "Comments"
                ],
                "summary": "Delete comment",
                "parameters": [
                    {
                        "name": "commentId",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Comment deleted"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden"
                    }
                }
            }
        },
        "/api/profile": {
            "put": {
                "tags": [
                    "Profile"
                ],
                "summary": "Update own profile",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ProfileUpdate"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Profile updated"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/users/{username}/profile": {
            "get": {
                "tags": [
                    "Profile"
                ],
                "summary": "Get user profile",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User profile",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "id": {
                                            "type": "string"
                                        },
                                        "username": {
                                            "type": "string"
                                        },
                                        "name": {
                                            "type": "string",
                                            "nullable": true
                                        },
                                        "bio": {
                                            "type": "string",
                                            "nullable": true
                                        },
                                        "profileImage": {
                                            "type": "string",
                                            "nullable": true
                                        },
                                        "displayColor": {
                                            "type": "string",
                                            "nullable": true
                                        },
                                        "_count": {
                                            "type": "object",
                                            "properties": {
                                                "followers": {
                                                    "type": "integer"
                                                },
                                                "following": {
                                                    "type": "integer"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found"
                    }
                }
            }
        },
        "/api/users/{username}/follow": {
            "post": {
                "tags": [
                    "Profile"
                ],
                "summary": "Follow a user",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User followed"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Profile"
                ],
                "summary": "Unfollow a user",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User unfollowed"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/users/{username}/follow-status": {
            "get": {
                "tags": [
                    "Profile"
                ],
                "summary": "Get follow status for a user",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Follow status",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "isFollowing": {
                                            "type": "boolean"
                                        },
                                        "isFollowedBy": {
                                            "type": "boolean"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/search": {
            "get": {
                "tags": [
                    "Search"
                ],
                "summary": "Search events",
                "parameters": [
                    {
                        "name": "q",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "name": "page",
                        "in": "query",
                        "schema": {
                            "type": "integer",
                            "default": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Search results",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Event"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/search/upcoming": {
            "get": {
                "tags": [
                    "Search"
                ],
                "summary": "Get upcoming events",
                "responses": {
                    "200": {
                        "description": "Upcoming events",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Event"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/search/popular": {
            "get": {
                "tags": [
                    "Search"
                ],
                "summary": "Get popular events",
                "responses": {
                    "200": {
                        "description": "Popular events",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Event"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/user-search": {
            "get": {
                "tags": [
                    "User Search"
                ],
                "summary": "Search for users (WebFinger)",
                "parameters": [
                    {
                        "name": "query",
                        "in": "query",
                        "required": true,
                        "description": "Username or @user@domain format",
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Search results",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/User"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/user-search/resolve": {
            "post": {
                "tags": [
                    "User Search"
                ],
                "summary": "Resolve remote user",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": [
                                    "query"
                                ],
                                "properties": {
                                    "query": {
                                        "type": "string",
                                        "description": "@user@domain format"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "User resolved"
                    }
                }
            }
        },
        "/api/user-search/profile/{username}": {
            "get": {
                "tags": [
                    "User Search"
                ],
                "summary": "Get user profile by username",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User profile",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/User"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/moderation/block/user": {
            "post": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Block a user",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/BlockUserInput"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "User blocked"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/moderation/block/user/{username}": {
            "delete": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Unblock a user",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User unblocked"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/moderation/block/users": {
            "get": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Get blocked users",
                "responses": {
                    "200": {
                        "description": "List of blocked users",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/moderation/block/domain": {
            "post": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Block a domain",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/BlockDomainInput"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Domain blocked"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/moderation/block/domain/{domain}": {
            "delete": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Unblock a domain",
                "parameters": [
                    {
                        "name": "domain",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Domain unblocked"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/moderation/block/domains": {
            "get": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Get blocked domains",
                "responses": {
                    "200": {
                        "description": "List of blocked domains",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "string"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/moderation/block/check/{username}": {
            "get": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Check if user is blocked",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Block status",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "isBlocked": {
                                            "type": "boolean"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/moderation/report": {
            "post": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Report content or user",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ReportInput"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Report created"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/moderation/reports": {
            "get": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Get reports (admin only)",
                "responses": {
                    "200": {
                        "description": "List of reports",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "id": {
                                                "type": "string"
                                            },
                                            "targetType": {
                                                "type": "string"
                                            },
                                            "targetId": {
                                                "type": "string"
                                            },
                                            "reason": {
                                                "type": "string"
                                            },
                                            "status": {
                                                "type": "string"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/moderation/reports/{id}": {
            "put": {
                "tags": [
                    "Moderation"
                ],
                "summary": "Update report status (admin only)",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": [
                                    "status"
                                ],
                                "properties": {
                                    "status": {
                                        "type": "string",
                                        "enum": [
                                            "pending",
                                            "resolved",
                                            "dismissed"
                                        ]
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Report updated"
                    }
                }
            }
        },
        "/api/calendar/{id}/export.ics": {
            "get": {
                "tags": [
                    "Calendar"
                ],
                "summary": "Export single event as iCal",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "iCal file",
                        "content": {
                            "text/calendar": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/calendar/user/{username}/export.ics": {
            "get": {
                "tags": [
                    "Calendar"
                ],
                "summary": "Export user's events as iCal",
                "parameters": [
                    {
                        "name": "username",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "iCal file",
                        "content": {
                            "text/calendar": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/calendar/feed.ics": {
            "get": {
                "tags": [
                    "Calendar"
                ],
                "summary": "Export own events as iCal feed",
                "responses": {
                    "200": {
                        "description": "iCal file",
                        "content": {
                            "text/calendar": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/realtime/stream": {
            "get": {
                "tags": [
                    "Realtime"
                ],
                "summary": "Server-sent events stream",
                "description": "Subscribe to real-time updates via Server-Sent Events (SSE). Events include:\n- Event updates: `event:created`, `event:updated`, `event:deleted`\n- Attendance: `attendance:added`, `attendance:updated`, `attendance:removed`\n- Likes: `like:added`, `like:removed`\n- Comments: `comment:added`, `comment:deleted`\n- Follows: `follow:added`, `follow:removed`, `follow:accepted`, `follow:pending`, `follow:rejected`\n- Followers: `follower:added`, `follower:removed`\n- Profile: `profile:updated`\n\nAll events include a `type` field and a `data` object with event-specific information. The stream sends a `connected` event on initial connection and periodic `heartbeat` events to keep the connection alive.",
                "responses": {
                    "200": {
                        "description": "SSE stream",
                        "content": {
                            "text/event-stream": {
                                "schema": {
                                    "type": "string",
                                    "description": "Server-Sent Events stream. Each event has an `event` field (event type) and a `data` field (JSON string with event data)."
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/users": {
            "get": {
                "tags": [
                    "Admin"
                ],
                "summary": "List users",
                "description": "List all users with pagination and filtering. Admin only.",
                "parameters": [
                    {
                        "name": "page",
                        "in": "query",
                        "schema": {
                            "type": "integer",
                            "default": 1,
                            "minimum": 1
                        }
                    },
                    {
                        "name": "limit",
                        "in": "query",
                        "schema": {
                            "type": "integer",
                            "default": 20,
                            "minimum": 1,
                            "maximum": 100
                        }
                    },
                    {
                        "name": "search",
                        "in": "query",
                        "schema": {
                            "type": "string"
                        },
                        "description": "Search by username, name, or email"
                    },
                    {
                        "name": "isBot",
                        "in": "query",
                        "schema": {
                            "type": "string",
                            "enum": [
                                "true",
                                "false"
                            ]
                        },
                        "description": "Filter by bot status"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User list",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/UserListResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden (not admin)"
                    }
                }
            },
            "post": {
                "tags": [
                    "Admin"
                ],
                "summary": "Create user",
                "description": "Create a new user. For bot users, password is not required. For regular users, password is required. Admin only.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateUserInput"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "User created",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AdminUser"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validation error or username/email already exists"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden (not admin)"
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/api/admin/users/{id}": {
            "get": {
                "tags": [
                    "Admin"
                ],
                "summary": "Get user by ID",
                "description": "Get detailed information about a specific user. Admin only.",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User details",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AdminUser"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "User not found"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden (not admin)"
                    }
                }
            },
            "put": {
                "tags": [
                    "Admin"
                ],
                "summary": "Update user",
                "description": "Update user information. Admin only.",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/UpdateUserInput"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "User updated",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AdminUser"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validation error or username/email already exists"
                    },
                    "404": {
                        "description": "User not found"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden (not admin)"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Admin"
                ],
                "summary": "Delete user",
                "description": "Delete a user. Cannot delete your own account. Admin only.",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "User deleted",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Cannot delete your own account"
                    },
                    "404": {
                        "description": "User not found"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden (not admin)"
                    }
                }
            }
        },
        "/api/admin/api-keys": {
            "get": {
                "tags": [
                    "Admin"
                ],
                "summary": "List API keys",
                "description": "List all API keys, optionally filtered by user. Admin only.",
                "parameters": [
                    {
                        "name": "userId",
                        "in": "query",
                        "schema": {
                            "type": "string"
                        },
                        "description": "Filter by user ID"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "API key list",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ApiKeyListResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden (not admin)"
                    }
                }
            },
            "post": {
                "tags": [
                    "Admin"
                ],
                "summary": "Create API key",
                "description": "Create a new API key for a user. The full key is only returned once on creation. Admin only.",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/CreateApiKeyInput"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "API key created",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ApiKeyCreateResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validation error"
                    },
                    "404": {
                        "description": "User not found"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden (not admin)"
                    }
                }
            }
        },
        "/api/admin/api-keys/{id}": {
            "delete": {
                "tags": [
                    "Admin"
                ],
                "summary": "Delete API key",
                "description": "Revoke an API key. Admin only.",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "API key deleted",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "API key not found"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden (not admin)"
                    }
                }
            }
        },
        "/api/setup/status": {
            "get": {
                "tags": [
                    "Setup"
                ],
                "summary": "Check if initial setup is required",
                "description": "Returns whether the instance needs initial setup (i.e., no users exist yet)",
                "security": [],
                "responses": {
                    "200": {
                        "description": "Setup status",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "setupRequired": {
                                            "type": "boolean",
                                            "description": "True if no users exist and setup is needed"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/setup": {
            "post": {
                "tags": [
                    "Setup"
                ],
                "summary": "Create first admin user",
                "description": "Creates the initial admin user for a new instance. Only works when no users exist.",
                "security": [],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": [
                                    "email",
                                    "username",
                                    "name"
                                ],
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "description": "Admin user email address"
                                    },
                                    "username": {
                                        "type": "string",
                                        "minLength": 1,
                                        "maxLength": 50,
                                        "description": "Admin username"
                                    },
                                    "name": {
                                        "type": "string",
                                        "description": "Admin display name"
                                    },
                                    "password": {
                                        "type": "string",
                                        "minLength": 8,
                                        "description": "Optional password. If not provided, user can only login via magic link."
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Admin user created successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "user": {
                                            "type": "object",
                                            "properties": {
                                                "id": {
                                                    "type": "string"
                                                },
                                                "email": {
                                                    "type": "string"
                                                },
                                                "username": {
                                                    "type": "string"
                                                },
                                                "name": {
                                                    "type": "string"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Missing required fields",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Setup already completed (users exist)",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Setup failed",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Error"
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}