{
	"openapi": "3.0.0",
	"info": {
		"title": "Constellate API",
		"version": "1.0.0",
		"description": "Federated event management platform implementing ActivityPub protocol",
		"license": {
			"name": "AGPL-3.0"
		}
	},
	"servers": [
		{
			"url": "http://localhost:3000",
			"description": "Development server"
		}
	],
	"tags": [
		{
			"name": "Events",
			"description": "Event management"
		},
		{
			"name": "Event Templates",
			"description": "Save and reuse event configurations"
		},
		{
			"name": "Attendance",
			"description": "Event attendance"
		},
		{
			"name": "Likes",
			"description": "Event likes"
		},
		{
			"name": "Comments",
			"description": "Event comments"
		},
		{
			"name": "Profile",
			"description": "User profiles"
		},
		{
			"name": "Search",
			"description": "Search functionality"
		},
		{
			"name": "Location",
			"description": "Location autocomplete and geocoding"
		},
		{
			"name": "User Search",
			"description": "WebFinger user search"
		},
		{
			"name": "Moderation",
			"description": "Blocking and reporting"
		},
		{
			"name": "Calendar",
			"description": "iCal exports"
		},
		{
			"name": "Realtime",
			"description": "Live updates"
		},
		{
			"name": "Notifications",
			"description": "User notifications and inbox"
		},
		{
			"name": "Recommendations",
			"description": "Personalized event suggestions"
		},
		{
			"name": "Admin",
			"description": "Administrative operations (admin only)"
		},
		{
			"name": "Setup",
			"description": "Initial instance setup and onboarding"
		},
		{
			"name": "Instances",
			"description": "Federated instance discovery and directory"
		}
	],
	"components": {
		"securitySchemes": {
			"cookieAuth": {
				"type": "apiKey",
				"in": "cookie",
				"name": "better-auth.session_token",
				"description": "Session-based authentication using cookies"
			},
			"apiKeyAuth": {
				"type": "http",
				"scheme": "bearer",
				"bearerFormat": "API Key",
				"description": "API key authentication. Use format: Bearer sk_live_..."
			}
		},
		"schemas": {
			"Error": {
				"type": "object",
				"properties": {
					"error": {
						"type": "string",
						"description": "Error code (e.g., VALIDATION_ERROR, UNAUTHORIZED, etc.)"
					},
					"message": {
						"type": "string",
						"description": "Human-readable error message"
					},
					"details": {
						"description": "Additional error details (only included in development mode)",
						"oneOf": [
							{
								"type": "object"
							},
							{
								"type": "array"
							}
						]
					}
				},
				"required": ["error", "message"]
			},
			"User": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string"
					},
					"username": {
						"type": "string"
					},
					"name": {
						"type": "string",
						"nullable": true
					},
					"displayColor": {
						"type": "string",
						"nullable": true
					},
					"profileImage": {
						"type": "string",
						"nullable": true
					},
					"isPublicProfile": {
						"type": "boolean",
						"description": "Profile visibility: true = public (visible to everyone), false = private (only visible to followers). Defaults to true.",
						"default": true
					}
				}
			},
			"Event": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string"
					},
					"title": {
						"type": "string"
					},
					"summary": {
						"type": "string",
						"nullable": true
					},
					"location": {
						"type": "string",
						"nullable": true
					},
					"locationLatitude": {
						"type": "number",
						"format": "double",
						"nullable": true,
						"description": "Latitude in decimal degrees"
					},
					"locationLongitude": {
						"type": "number",
						"format": "double",
						"nullable": true,
						"description": "Longitude in decimal degrees"
					},
					"startTime": {
						"type": "string",
						"format": "date-time"
					},
					"endTime": {
						"type": "string",
						"format": "date-time",
						"nullable": true
					},
					"recurrencePattern": {
						"type": "string",
						"nullable": true,
						"enum": ["DAILY", "WEEKLY", "MONTHLY"],
						"description": "Recurring frequency (DAILY, WEEKLY, MONTHLY)"
					},
					"recurrenceEndDate": {
						"type": "string",
						"format": "date-time",
						"nullable": true,
						"description": "Date when the recurrence pattern ends"
					},
					"user": {
						"$ref": "#/components/schemas/User"
					},
					"visibility": {
						"type": "string",
						"enum": ["PUBLIC", "FOLLOWERS", "PRIVATE", "UNLISTED"]
					},
					"tags": {
						"type": "array",
						"description": "Tags associated with this event for categorization and discovery",
						"items": {
							"type": "object",
							"properties": {
								"id": {
									"type": "string"
								},
								"tag": {
									"type": "string",
									"description": "Tag name (without # prefix)"
								}
							}
						}
					},
					"sharedEvent": {
						"$ref": "#/components/schemas/SharedEvent",
						"nullable": true
					},
					"distanceKm": {
						"type": "number",
						"format": "double",
						"nullable": true,
						"description": "Optional distance in kilometers relative to the provided origin (nearby search)"
					}
				}
			},
			"SharedEvent": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string"
					},
					"title": {
						"type": "string"
					},
					"summary": {
						"type": "string",
						"nullable": true
					},
					"location": {
						"type": "string",
						"nullable": true
					},
					"startTime": {
						"type": "string",
						"format": "date-time"
					},
					"endTime": {
						"type": "string",
						"format": "date-time",
						"nullable": true
					},
					"visibility": {
						"type": "string",
						"enum": ["PUBLIC", "FOLLOWERS", "PRIVATE", "UNLISTED"]
					},
					"user": {
						"$ref": "#/components/schemas/User"
					}
				}
			},
			"EventInput": {
				"type": "object",
				"required": ["title", "startTime"],
				"properties": {
					"title": {
						"type": "string",
						"minLength": 1,
						"maxLength": 200
					},
					"summary": {
						"type": "string"
					},
					"location": {
						"type": "string"
					},
					"headerImage": {
						"type": "string",
						"format": "uri"
					},
					"url": {
						"type": "string",
						"format": "uri"
					},
					"startTime": {
						"type": "string",
						"format": "date-time"
					},
					"endTime": {
						"type": "string",
						"format": "date-time"
					},
					"eventStatus": {
						"type": "string",
						"enum": ["EventScheduled", "EventCancelled", "EventPostponed"]
					},
					"eventAttendanceMode": {
						"type": "string",
						"enum": [
							"OfflineEventAttendanceMode",
							"OnlineEventAttendanceMode",
							"MixedEventAttendanceMode"
						]
					},
					"maximumAttendeeCapacity": {
						"type": "integer",
						"minimum": 1
					},
					"visibility": {
						"type": "string",
						"enum": ["PUBLIC", "FOLLOWERS", "PRIVATE", "UNLISTED"]
					},
					"recurrencePattern": {
						"type": "string",
						"enum": ["DAILY", "WEEKLY", "MONTHLY"],
						"description": "Recurring frequency for the event"
					},
					"recurrenceEndDate": {
						"type": "string",
						"format": "date-time",
						"description": "Timestamp for when the recurrence stops"
					},
					"tags": {
						"type": "array",
						"items": {
							"type": "string",
							"minLength": 1,
							"maxLength": 50,
							"description": "Tag name (without # prefix, will be normalized to lowercase)"
						},
						"description": "Array of tags to categorize the event"
					}
				}
			},
			"EventTemplateData": {
				"type": "object",
				"required": ["title"],
				"properties": {
					"title": {
						"type": "string",
						"minLength": 1,
						"maxLength": 200
					},
					"summary": {
						"type": "string"
					},
					"location": {
						"type": "string"
					},
					"headerImage": {
						"type": "string",
						"format": "uri"
					},
					"url": {
						"type": "string",
						"format": "uri"
					},
					"startTime": {
						"type": "string",
						"format": "date-time"
					},
					"endTime": {
						"type": "string",
						"format": "date-time"
					},
					"duration": {
						"type": "string"
					},
					"eventStatus": {
						"type": "string",
						"enum": ["EventScheduled", "EventCancelled", "EventPostponed"]
					},
					"eventAttendanceMode": {
						"type": "string",
						"enum": [
							"OfflineEventAttendanceMode",
							"OnlineEventAttendanceMode",
							"MixedEventAttendanceMode"
						]
					},
					"maximumAttendeeCapacity": {
						"type": "integer",
						"minimum": 1
					}
				}
			},
			"LocationSuggestion": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string",
						"description": "Provider-specific identifier"
					},
					"label": {
						"type": "string",
						"description": "Human-readable place name"
					},
					"hint": {
						"type": "string",
						"nullable": true,
						"description": "Short hint (city/state/country)"
					},
					"latitude": {
						"type": "number",
						"format": "double"
					},
					"longitude": {
						"type": "number",
						"format": "double"
					},
					"importance": {
						"type": "number",
						"format": "double",
						"nullable": true
					},
					"type": {
						"type": "string",
						"nullable": true
					},
					"class": {
						"type": "string",
						"nullable": true
					}
				},
				"required": ["id", "label", "latitude", "longitude"]
			},
			"EventTemplateDataUpdate": {
				"type": "object",
				"properties": {
					"title": {
						"type": "string",
						"minLength": 1,
						"maxLength": 200
					},
					"summary": {
						"type": "string"
					},
					"location": {
						"type": "string"
					},
					"headerImage": {
						"type": "string",
						"format": "uri"
					},
					"url": {
						"type": "string",
						"format": "uri"
					},
					"startTime": {
						"type": "string",
						"format": "date-time"
					},
					"endTime": {
						"type": "string",
						"format": "date-time"
					},
					"duration": {
						"type": "string"
					},
					"eventStatus": {
						"type": "string",
						"enum": ["EventScheduled", "EventCancelled", "EventPostponed"]
					},
					"eventAttendanceMode": {
						"type": "string",
						"enum": [
							"OfflineEventAttendanceMode",
							"OnlineEventAttendanceMode",
							"MixedEventAttendanceMode"
						]
					},
					"maximumAttendeeCapacity": {
						"type": "integer",
						"minimum": 1
					}
				}
			},
			"EventTemplateInput": {
				"type": "object",
				"required": ["name", "data"],
				"properties": {
					"name": {
						"type": "string",
						"minLength": 1,
						"maxLength": 120
					},
					"description": {
						"type": "string",
						"maxLength": 500
					},
					"data": {
						"$ref": "#/components/schemas/EventTemplateData"
					}
				}
			},
			"EventTemplate": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string"
					},
					"name": {
						"type": "string"
					},
					"description": {
						"type": "string",
						"nullable": true
					},
					"data": {
						"$ref": "#/components/schemas/EventTemplateData"
					},
					"createdAt": {
						"type": "string",
						"format": "date-time"
					},
					"updatedAt": {
						"type": "string",
						"format": "date-time"
					}
				}
			},
			"EventTemplateUpdate": {
				"type": "object",
				"properties": {
					"name": {
						"type": "string",
						"minLength": 1,
						"maxLength": 120
					},
					"description": {
						"type": "string",
						"maxLength": 500
					},
					"data": {
						"$ref": "#/components/schemas/EventTemplateDataUpdate"
					}
				}
			},
			"EventTemplateList": {
				"type": "object",
				"properties": {
					"templates": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/EventTemplate"
						}
					}
				}
			},
			"AttendanceInput": {
				"type": "object",
				"required": ["status"],
				"properties": {
					"status": {
						"type": "string",
						"enum": ["attending", "maybe", "not_attending"]
					},
					"reminderMinutesBeforeStart": {
						"type": "integer",
						"nullable": true,
						"description": "Optional reminder offset in minutes before event start",
						"enum": [5, 15, 30, 60, 120, 1440]
					}
				}
			},
			"CommentInput": {
				"type": "object",
				"required": ["content"],
				"properties": {
					"content": {
						"type": "string",
						"minLength": 1,
						"maxLength": 5000
					},
					"inReplyToId": {
						"type": "string",
						"nullable": true
					}
				}
			},
			"ReminderRequest": {
				"type": "object",
				"required": ["minutesBeforeStart"],
				"properties": {
					"minutesBeforeStart": {
						"type": "integer",
						"description": "Minutes before the event starts to send the reminder",
						"enum": [5, 15, 30, 60, 120, 1440]
					}
				}
			},
			"EventReminder": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string"
					},
					"eventId": {
						"type": "string"
					},
					"userId": {
						"type": "string"
					},
					"minutesBeforeStart": {
						"type": "integer"
					},
					"status": {
						"type": "string",
						"enum": ["PENDING", "SENDING", "SENT", "FAILED", "CANCELLED"]
					},
					"remindAt": {
						"type": "string",
						"format": "date-time"
					},
					"createdAt": {
						"type": "string",
						"format": "date-time"
					},
					"updatedAt": {
						"type": "string",
						"format": "date-time"
					},
					"deliveredAt": {
						"type": "string",
						"format": "date-time",
						"nullable": true
					},
					"lastAttemptAt": {
						"type": "string",
						"format": "date-time",
						"nullable": true
					},
					"failureReason": {
						"type": "string",
						"nullable": true
					}
				}
			},
			"CommentMention": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string"
					},
					"handle": {
						"type": "string"
					},
					"user": {
						"$ref": "#/components/schemas/User"
					}
				}
			},
			"ProfileUpdate": {
				"type": "object",
				"properties": {
					"name": {
						"type": "string",
						"maxLength": 100
					},
					"bio": {
						"type": "string",
						"maxLength": 500
					},
					"profileImage": {
						"type": "string",
						"format": "uri"
					},
					"headerImage": {
						"type": "string",
						"format": "uri"
					},
					"displayColor": {
						"type": "string",
						"pattern": "^#[0-9A-Fa-f]{6}$"
					},
					"isPublicProfile": {
						"type": "boolean",
						"description": "Set profile visibility: true = public (visible to everyone), false = private (only visible to followers). When private, non-followers will only see username, name, and profile image."
					},
					"autoAcceptFollowers": {
						"type": "boolean",
						"description": "Automatically accept follow requests. When disabled, manual approval is required."
					},
					"timezone": {
						"type": "string",
						"description": "IANA timezone identifier (e.g., 'America/New_York')"
					}
				}
			},
			"BlockUserInput": {
				"type": "object",
				"required": ["username"],
				"properties": {
					"username": {
						"type": "string"
					}
				}
			},
			"BlockDomainInput": {
				"type": "object",
				"required": ["domain"],
				"properties": {
					"domain": {
						"type": "string"
					}
				}
			},
			"ReportInput": {
				"type": "object",
				"required": ["targetType", "targetId", "reason"],
				"properties": {
					"targetType": {
						"type": "string",
						"enum": ["user", "event", "comment"]
					},
					"targetId": {
						"type": "string"
					},
					"reason": {
						"type": "string",
						"minLength": 1,
						"maxLength": 1000
					},
					"category": {
						"type": "string",
						"enum": ["spam", "harassment", "inappropriate", "other"],
						"description": "Report category (defaults to 'other' if not provided)"
					}
				}
			},
			"AppealInput": {
				"type": "object",
				"required": ["type", "reason"],
				"properties": {
					"type": {
						"type": "string",
						"enum": ["ACCOUNT_SUSPENSION", "CONTENT_REMOVAL"],
						"description": "Type of appeal"
					},
					"reason": {
						"type": "string",
						"minLength": 1,
						"maxLength": 2000,
						"description": "Reason for the appeal"
					},
					"referenceId": {
						"type": "string",
						"description": "Optional reference ID (e.g., event ID, report ID)"
					},
					"referenceType": {
						"type": "string",
						"description": "Optional reference type (e.g., 'event', 'report')"
					}
				}
			},
			"AppealUpdateInput": {
				"type": "object",
				"required": ["status"],
				"properties": {
					"status": {
						"type": "string",
						"enum": ["approved", "rejected"],
						"description": "Appeal resolution status (case-insensitive, accepts lowercase; will be converted to uppercase enum: APPROVED or REJECTED)"
					},
					"adminNotes": {
						"type": "string",
						"description": "Optional admin notes about the resolution"
					}
				}
			},
			"Appeal": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string"
					},
					"userId": {
						"type": "string"
					},
					"type": {
						"type": "string",
						"enum": ["ACCOUNT_SUSPENSION", "CONTENT_REMOVAL"],
						"description": "Type of appeal"
					},
					"reason": {
						"type": "string"
					},
					"referenceId": {
						"type": "string",
						"nullable": true
					},
					"referenceType": {
						"type": "string",
						"nullable": true
					},
					"status": {
						"type": "string",
						"enum": ["PENDING", "APPROVED", "REJECTED"],
						"description": "Appeal status (Prisma enum: AppealStatus)"
					},
					"adminNotes": {
						"type": "string",
						"nullable": true
					},
					"resolvedAt": {
						"type": "string",
						"format": "date-time",
						"nullable": true
					},
					"resolvedBy": {
						"type": "string",
						"nullable": true
					},
					"createdAt": {
						"type": "string",
						"format": "date-time"
					},
					"user": {
						"type": "object",
						"properties": {
							"id": {
								"type": "string"
							},
							"username": {
								"type": "string"
							},
							"name": {
								"type": "string",
								"nullable": true
							}
						},
						"description": "User information (included in admin endpoints)"
					}
				}
			},
			"AdminUser": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string"
					},
					"username": {
						"type": "string"
					},
					"email": {
						"type": "string",
						"nullable": true
					},
					"name": {
						"type": "string",
						"nullable": true
					},
					"isAdmin": {
						"type": "boolean"
					},
					"isBot": {
						"type": "boolean"
					},
					"isRemote": {
						"type": "boolean"
					},
					"displayColor": {
						"type": "string",
						"nullable": true
					},
					"bio": {
						"type": "string",
						"nullable": true
					},
					"createdAt": {
						"type": "string",
						"format": "date-time"
					},
					"updatedAt": {
						"type": "string",
						"format": "date-time"
					},
					"_count": {
						"type": "object",
						"properties": {
							"events": {
								"type": "integer"
							},
							"followers": {
								"type": "integer"
							},
							"following": {
								"type": "integer"
							},
							"apiKeys": {
								"type": "integer"
							}
						}
					}
				}
			},
			"CreateUserInput": {
				"type": "object",
				"required": ["username"],
				"properties": {
					"username": {
						"type": "string",
						"minLength": 1,
						"maxLength": 50
					},
					"email": {
						"type": "string",
						"format": "email"
					},
					"name": {
						"type": "string"
					},
					"isAdmin": {
						"type": "boolean",
						"default": false
					},
					"isBot": {
						"type": "boolean",
						"default": false
					},
					"displayColor": {
						"type": "string"
					},
					"bio": {
						"type": "string"
					},
					"password": {
						"type": "string",
						"minLength": 8,
						"description": "Required for non-bot users"
					}
				}
			},
			"UpdateUserInput": {
				"type": "object",
				"properties": {
					"username": {
						"type": "string",
						"minLength": 1,
						"maxLength": 50
					},
					"email": {
						"type": "string",
						"format": "email"
					},
					"name": {
						"type": "string"
					},
					"isAdmin": {
						"type": "boolean"
					},
					"isBot": {
						"type": "boolean"
					},
					"displayColor": {
						"type": "string"
					},
					"bio": {
						"type": "string"
					}
				}
			},
			"ApiKey": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string"
					},
					"name": {
						"type": "string"
					},
					"description": {
						"type": "string",
						"nullable": true
					},
					"prefix": {
						"type": "string",
						"description": "First 12 characters of the key for display"
					},
					"userId": {
						"type": "string"
					},
					"user": {
						"type": "object",
						"properties": {
							"id": {
								"type": "string"
							},
							"username": {
								"type": "string"
							},
							"name": {
								"type": "string",
								"nullable": true
							}
						}
					},
					"createdAt": {
						"type": "string",
						"format": "date-time"
					},
					"updatedAt": {
						"type": "string",
						"format": "date-time"
					},
					"lastUsedAt": {
						"type": "string",
						"format": "date-time",
						"nullable": true
					}
				}
			},
			"ApiKeyCreateResponse": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string"
					},
					"name": {
						"type": "string"
					},
					"description": {
						"type": "string",
						"nullable": true
					},
					"key": {
						"type": "string",
						"description": "Full API key (only returned on creation)"
					},
					"prefix": {
						"type": "string"
					},
					"userId": {
						"type": "string"
					},
					"user": {
						"type": "object",
						"properties": {
							"id": {
								"type": "string"
							},
							"username": {
								"type": "string"
							},
							"name": {
								"type": "string",
								"nullable": true
							}
						}
					},
					"createdAt": {
						"type": "string",
						"format": "date-time"
					},
					"warning": {
						"type": "string",
						"description": "Warning message about saving the key"
					}
				}
			},
			"CreateApiKeyInput": {
				"type": "object",
				"required": ["userId", "name"],
				"properties": {
					"userId": {
						"type": "string"
					},
					"name": {
						"type": "string",
						"minLength": 1,
						"maxLength": 100
					},
					"description": {
						"type": "string",
						"maxLength": 500
					}
				}
			},
			"UserListResponse": {
				"type": "object",
				"properties": {
					"users": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/AdminUser"
						}
					},
					"pagination": {
						"type": "object",
						"properties": {
							"page": {
								"type": "integer"
							},
							"limit": {
								"type": "integer"
							},
							"total": {
								"type": "integer"
							},
							"pages": {
								"type": "integer"
							}
						}
					}
				}
			},
			"ApiKeyListResponse": {
				"type": "object",
				"properties": {
					"apiKeys": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/ApiKey"
						}
					}
				}
			},
			"NotificationActor": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string"
					},
					"username": {
						"type": "string"
					},
					"name": {
						"type": "string",
						"nullable": true
					},
					"displayColor": {
						"type": "string",
						"nullable": true
					},
					"profileImage": {
						"type": "string",
						"nullable": true
					}
				}
			},
			"Notification": {
				"type": "object",
				"properties": {
					"id": {
						"type": "string"
					},
					"type": {
						"type": "string",
						"enum": ["FOLLOW", "COMMENT", "LIKE", "MENTION", "EVENT", "SYSTEM"]
					},
					"title": {
						"type": "string"
					},
					"body": {
						"type": "string",
						"nullable": true
					},
					"contextUrl": {
						"type": "string",
						"nullable": true
					},
					"data": {
						"type": "object",
						"additionalProperties": true,
						"nullable": true
					},
					"read": {
						"type": "boolean"
					},
					"readAt": {
						"type": "string",
						"format": "date-time",
						"nullable": true
					},
					"createdAt": {
						"type": "string",
						"format": "date-time"
					},
					"updatedAt": {
						"type": "string",
						"format": "date-time"
					},
					"actor": {
						"$ref": "#/components/schemas/NotificationActor",
						"nullable": true
					}
				}
			},
			"NotificationListResponse": {
				"type": "object",
				"properties": {
					"notifications": {
						"type": "array",
						"items": {
							"$ref": "#/components/schemas/Notification"
						}
					},
					"unreadCount": {
						"type": "integer"
					}
				}
			},
			"NotificationMarkAllResponse": {
				"type": "object",
				"properties": {
					"updated": {
						"type": "integer"
					},
					"unreadCount": {
						"type": "integer"
					}
				}
			}
		}
	},
	"security": [
		{
			"cookieAuth": []
		},
		{
			"apiKeyAuth": []
		}
	],
	"paths": {
		"/api/notifications": {
			"get": {
				"tags": ["Notifications"],
				"summary": "List notifications for current user",
				"parameters": [
					{
						"name": "limit",
						"in": "query",
						"schema": {
							"type": "integer",
							"default": 20,
							"minimum": 1,
							"maximum": 100
						}
					}
				],
				"responses": {
					"200": {
						"description": "List of notifications",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/NotificationListResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			}
		},
		"/api/notifications/{notificationId}/read": {
			"post": {
				"tags": ["Notifications"],
				"summary": "Mark a notification as read",
				"parameters": [
					{
						"name": "notificationId",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Notification marked as read",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"notification": {
											"$ref": "#/components/schemas/Notification"
										}
									}
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					},
					"404": {
						"description": "Notification not found"
					}
				}
			}
		},
		"/api/notifications/mark-all-read": {
			"post": {
				"tags": ["Notifications"],
				"summary": "Mark all notifications as read",
				"responses": {
					"200": {
						"description": "All notifications marked as read",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/NotificationMarkAllResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			}
		},
		"/api/events": {
			"post": {
				"tags": ["Events"],
				"summary": "Create a new event",
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/EventInput"
							}
						}
					}
				},
				"responses": {
					"201": {
						"description": "Event created",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Event"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					},
					"400": {
						"description": "Validation error - occurs when input validation fails (e.g., invalid tags, missing required fields, or tag normalization fails)",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								},
								"examples": {
									"tagValidationError": {
										"summary": "Tag validation error",
										"value": {
											"error": "VALIDATION_ERROR",
											"message": "Failed to process tags: ensure tags are valid strings"
										}
									},
									"schemaValidationError": {
										"summary": "Schema validation error",
										"value": {
											"error": "VALIDATION_ERROR",
											"message": "Invalid input data",
											"details": [
												{
													"code": "invalid_type",
													"expected": "string",
													"received": "number",
													"path": ["title"],
													"message": "Expected string, received number"
												}
											]
										}
									}
								}
							}
						}
					}
				}
			},
			"get": {
				"tags": ["Events"],
				"summary": "List events",
				"parameters": [
					{
						"name": "page",
						"in": "query",
						"schema": {
							"type": "integer",
							"default": 1
						}
					},
					{
						"name": "limit",
						"in": "query",
						"schema": {
							"type": "integer",
							"default": 20
						}
					}
				],
				"responses": {
					"200": {
						"description": "List of events",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"events": {
											"type": "array",
											"items": {
												"$ref": "#/components/schemas/Event"
											}
										},
										"pagination": {
											"type": "object",
											"properties": {
												"page": {
													"type": "integer"
												},
												"limit": {
													"type": "integer"
												},
												"total": {
													"type": "integer"
												},
												"pages": {
													"type": "integer"
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		},
		"/api/event-templates": {
			"get": {
				"tags": ["Event Templates"],
				"summary": "List event templates for the authenticated user",
				"responses": {
					"200": {
						"description": "List of event templates",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/EventTemplateList"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			},
			"post": {
				"tags": ["Event Templates"],
				"summary": "Create a new event template",
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/EventTemplateInput"
							}
						}
					}
				},
				"responses": {
					"201": {
						"description": "Template created",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/EventTemplate"
								}
							}
						}
					},
					"400": {
						"description": "Validation error - occurs when input validation fails (e.g., invalid tags, missing required fields, or tag normalization fails)",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								},
								"examples": {
									"tagValidationError": {
										"summary": "Tag validation error",
										"value": {
											"error": "VALIDATION_ERROR",
											"message": "Failed to process tags: ensure tags are valid strings"
										}
									},
									"schemaValidationError": {
										"summary": "Schema validation error",
										"value": {
											"error": "VALIDATION_ERROR",
											"message": "Invalid input data",
											"details": [
												{
													"code": "invalid_type",
													"expected": "string",
													"received": "number",
													"path": ["title"],
													"message": "Expected string, received number"
												}
											]
										}
									}
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					},
					"409": {
						"description": "Duplicate template name"
					}
				}
			}
		},
		"/api/event-templates/{id}": {
			"get": {
				"tags": ["Event Templates"],
				"summary": "Get an event template by ID",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Template details",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/EventTemplate"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					},
					"404": {
						"description": "Template not found"
					}
				}
			},
			"put": {
				"tags": ["Event Templates"],
				"summary": "Update an event template",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/EventTemplateUpdate"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Updated template",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/EventTemplate"
								}
							}
						}
					},
					"400": {
						"description": "Validation error - occurs when input validation fails (e.g., invalid tags, missing required fields, or tag normalization fails)",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								},
								"examples": {
									"tagValidationError": {
										"summary": "Tag validation error",
										"value": {
											"error": "VALIDATION_ERROR",
											"message": "Failed to process tags: ensure tags are valid strings"
										}
									},
									"schemaValidationError": {
										"summary": "Schema validation error",
										"value": {
											"error": "VALIDATION_ERROR",
											"message": "Invalid input data",
											"details": [
												{
													"code": "invalid_type",
													"expected": "string",
													"received": "number",
													"path": ["title"],
													"message": "Expected string, received number"
												}
											]
										}
									}
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					},
					"404": {
						"description": "Template not found"
					},
					"409": {
						"description": "Duplicate template name"
					}
				}
			},
			"delete": {
				"tags": ["Event Templates"],
				"summary": "Delete an event template",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Deletion result",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean"
										}
									}
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					},
					"404": {
						"description": "Template not found"
					}
				}
			}
		},
		"/api/events/{id}": {
			"get": {
				"tags": ["Events"],
				"summary": "Get event by ID",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Event details",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Event"
								}
							}
						}
					},
					"404": {
						"description": "Event not found"
					}
				}
			},
			"put": {
				"tags": ["Events"],
				"summary": "Update event",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/EventInput"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Event updated",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Event"
								}
							}
						}
					},
					"400": {
						"description": "Validation error - occurs when input validation fails (e.g., invalid tags, missing required fields, or tag normalization fails)",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					},
					"403": {
						"description": "Forbidden"
					},
					"404": {
						"description": "Event not found"
					}
				}
			},
			"delete": {
				"tags": ["Events"],
				"summary": "Delete event",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Event deleted"
					},
					"401": {
						"description": "Unauthorized"
					},
					"403": {
						"description": "Forbidden"
					},
					"404": {
						"description": "Event not found"
					}
				}
			}
		},
		"/api/events/by-user/{username}/{eventId}": {
			"get": {
				"tags": ["Events"],
				"summary": "Get event by username and event ID",
				"parameters": [
					{
						"name": "username",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					},
					{
						"name": "eventId",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Event details",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Event"
								}
							}
						}
					},
					"404": {
						"description": "Event not found"
					}
				}
			}
		},
		"/api/events/{id}/attend": {
			"post": {
				"tags": ["Attendance"],
				"summary": "Set attendance status",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/AttendanceInput"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Attendance set"
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			},
			"delete": {
				"tags": ["Attendance"],
				"summary": "Remove attendance",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Attendance removed"
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			}
		},
		"/api/events/{eventId}/reminders": {
			"get": {
				"tags": ["Reminders"],
				"summary": "List reminder settings for the authenticated user",
				"parameters": [
					{
						"name": "eventId",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Reminder settings",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"reminders": {
											"type": "array",
											"items": {
												"$ref": "#/components/schemas/EventReminder"
											}
										},
										"options": {
											"type": "array",
											"items": {
												"type": "integer"
											}
										}
									}
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			},
			"post": {
				"tags": ["Reminders"],
				"summary": "Create or update an event reminder",
				"parameters": [
					{
						"name": "eventId",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/ReminderRequest"
							}
						}
					}
				},
				"responses": {
					"201": {
						"description": "Reminder saved",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"reminder": {
											"$ref": "#/components/schemas/EventReminder"
										}
									}
								}
							}
						}
					},
					"400": {
						"description": "Invalid reminder settings"
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			},
			"delete": {
				"tags": ["Reminders"],
				"summary": "Remove the reminder for the authenticated user",
				"parameters": [
					{
						"name": "eventId",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Reminder removed",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean"
										}
									}
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			}
		},
		"/api/events/{eventId}/reminders/{reminderId}": {
			"delete": {
				"tags": ["Reminders"],
				"summary": "Cancel a specific reminder",
				"parameters": [
					{
						"name": "eventId",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					},
					{
						"name": "reminderId",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Reminder cancelled",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"reminder": {
											"$ref": "#/components/schemas/EventReminder"
										}
									}
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					},
					"404": {
						"description": "Reminder not found"
					}
				}
			}
		},
		"/api/events/{id}/attendees": {
			"get": {
				"tags": ["Attendance"],
				"summary": "Get event attendees",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "List of attendees",
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {
										"type": "object",
										"properties": {
											"status": {
												"type": "string"
											},
											"user": {
												"$ref": "#/components/schemas/User"
											}
										}
									}
								}
							}
						}
					}
				}
			}
		},
		"/api/events/{id}/like": {
			"post": {
				"tags": ["Likes"],
				"summary": "Like an event",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Event liked"
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			},
			"delete": {
				"tags": ["Likes"],
				"summary": "Unlike an event",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Event unliked"
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			}
		},
		"/api/events/{id}/share": {
			"post": {
				"tags": ["Events"],
				"summary": "Share or repost an event",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"201": {
						"description": "Event shared",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"share": {
											"$ref": "#/components/schemas/Event"
										},
										"alreadyShared": {
											"type": "boolean"
										}
									}
								}
							}
						}
					},
					"200": {
						"description": "Event was already shared by this user",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"share": {
											"$ref": "#/components/schemas/Event"
										},
										"alreadyShared": {
											"type": "boolean"
										}
									}
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					},
					"403": {
						"description": "Sharing not allowed"
					},
					"404": {
						"description": "Event not found"
					}
				}
			}
		},
		"/api/events/{id}/likes": {
			"get": {
				"tags": ["Likes"],
				"summary": "Get event likes",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "List of users who liked the event",
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {
										"$ref": "#/components/schemas/User"
									}
								}
							}
						}
					}
				}
			}
		},
		"/api/events/{id}/comments": {
			"post": {
				"tags": ["Comments"],
				"summary": "Add comment to event",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/CommentInput"
							}
						}
					}
				},
				"responses": {
					"201": {
						"description": "Comment created"
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			},
			"get": {
				"tags": ["Comments"],
				"summary": "Get event comments",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "List of comments",
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {
										"type": "object",
										"properties": {
											"id": {
												"type": "string"
											},
											"content": {
												"type": "string"
											},
											"author": {
												"$ref": "#/components/schemas/User"
											},
											"createdAt": {
												"type": "string",
												"format": "date-time"
											}
										}
									}
								}
							}
						}
					}
				}
			}
		},
		"/api/comments/{commentId}": {
			"delete": {
				"tags": ["Comments"],
				"summary": "Delete comment",
				"parameters": [
					{
						"name": "commentId",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Comment deleted"
					},
					"401": {
						"description": "Unauthorized"
					},
					"403": {
						"description": "Forbidden"
					}
				}
			}
		},
		"/api/profile": {
			"put": {
				"tags": ["Profile"],
				"summary": "Update own profile",
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/ProfileUpdate"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Profile updated"
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			}
		},
		"/api/users/{username}/profile": {
			"get": {
				"tags": ["Profile"],
				"summary": "Get user profile",
				"description": "Returns user profile information. For private profiles (isPublicProfile: false), non-followers will only receive minimal data: id, username, name, and profileImage. Full profile data (bio, headerImage, follower/following counts) is only returned to the profile owner or accepted followers.",
				"parameters": [
					{
						"name": "username",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "User profile. For private profiles, non-followers receive minimal data (id, username, name, profileImage only).",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"id": {
											"type": "string"
										},
										"username": {
											"type": "string"
										},
										"name": {
											"type": "string",
											"nullable": true,
											"description": "Always included, even for private profiles"
										},
										"bio": {
											"type": "string",
											"nullable": true,
											"description": "Only included for public profiles or when viewer is owner/follower"
										},
										"profileImage": {
											"type": "string",
											"nullable": true,
											"description": "Always included, even for private profiles"
										},
										"headerImage": {
											"type": "string",
											"nullable": true,
											"description": "Only included for public profiles or when viewer is owner/follower"
										},
										"displayColor": {
											"type": "string",
											"nullable": true,
											"description": "Only included for public profiles or when viewer is owner/follower"
										},
										"isPublicProfile": {
											"type": "boolean",
											"description": "Profile visibility setting"
										},
										"_count": {
											"type": "object",
											"properties": {
												"followers": {
													"type": "integer",
													"description": "Only included for public profiles or when viewer is owner/follower"
												},
												"following": {
													"type": "integer",
													"description": "Only included for public profiles or when viewer is owner/follower"
												}
											},
											"description": "Only included for public profiles or when viewer is owner/follower"
										}
									}
								}
							}
						}
					},
					"404": {
						"description": "User not found"
					}
				}
			}
		},
		"/api/users/me/export": {
			"post": {
				"tags": ["Profile"],
				"summary": "Request data export (GDPR)",
				"description": "Creates an asynchronous background job to export all user data. The export will be processed in the background and the user will be notified when it's ready.",
				"responses": {
					"202": {
						"description": "Export job created",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"exportId": {
											"type": "string"
										},
										"status": {
											"type": "string",
											"enum": ["PENDING", "PROCESSING", "COMPLETED", "FAILED"]
										},
										"message": {
											"type": "string"
										}
									}
								}
							}
						}
					},
					"200": {
						"description": "Existing export job found",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"exportId": {
											"type": "string"
										},
										"status": {
											"type": "string",
											"enum": ["PENDING", "PROCESSING"]
										},
										"message": {
											"type": "string"
										}
									}
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			}
		},
		"/api/users/me/export/{exportId}": {
			"get": {
				"tags": ["Profile"],
				"summary": "Get export status or download",
				"description": "Returns the export status if not completed, or the full export data if completed. Exports expire after 7 days.",
				"parameters": [
					{
						"name": "exportId",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Export status or data",
						"content": {
							"application/json": {
								"schema": {
									"oneOf": [
										{
											"type": "object",
											"properties": {
												"exportId": {
													"type": "string"
												},
												"status": {
													"type": "string",
													"enum": ["PENDING", "PROCESSING", "FAILED"]
												},
												"createdAt": {
													"type": "string",
													"format": "date-time"
												},
												"updatedAt": {
													"type": "string",
													"format": "date-time"
												},
												"errorMessage": {
													"type": "string",
													"nullable": true
												}
											}
										},
										{
											"type": "object",
											"description": "Full export data when status is COMPLETED"
										}
									]
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					},
					"403": {
						"description": "Forbidden - export belongs to another user"
					},
					"404": {
						"description": "Export not found"
					},
					"410": {
						"description": "Export has expired"
					}
				}
			}
		},
		"/api/users/{username}/follow": {
			"post": {
				"tags": ["Profile"],
				"summary": "Follow a user",
				"parameters": [
					{
						"name": "username",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "User followed"
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			},
			"delete": {
				"tags": ["Profile"],
				"summary": "Unfollow a user",
				"parameters": [
					{
						"name": "username",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "User unfollowed"
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			}
		},
		"/api/users/{username}/follow-status": {
			"get": {
				"tags": ["Profile"],
				"summary": "Get follow status for a user",
				"parameters": [
					{
						"name": "username",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Follow status",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"isFollowing": {
											"type": "boolean"
										},
										"isFollowedBy": {
											"type": "boolean"
										}
									}
								}
							}
						}
					}
				}
			}
		},
		"/api/search": {
			"get": {
				"tags": ["Search"],
				"summary": "Search events",
				"parameters": [
					{
						"name": "q",
						"in": "query",
						"schema": {
							"type": "string"
						},
						"description": "Search query (searches in title and summary)"
					},
					{
						"name": "location",
						"in": "query",
						"schema": {
							"type": "string"
						},
						"description": "Filter by location"
					},
					{
						"name": "startDate",
						"in": "query",
						"schema": {
							"type": "string",
							"format": "date-time"
						},
						"description": "Filter events starting from this date"
					},
					{
						"name": "endDate",
						"in": "query",
						"schema": {
							"type": "string",
							"format": "date-time"
						},
						"description": "Filter events ending before this date"
					},
					{
						"name": "status",
						"in": "query",
						"schema": {
							"type": "string",
							"enum": ["EventScheduled", "EventCancelled", "EventPostponed"]
						},
						"description": "Filter by event status"
					},
					{
						"name": "mode",
						"in": "query",
						"schema": {
							"type": "string",
							"enum": [
								"OfflineEventAttendanceMode",
								"OnlineEventAttendanceMode",
								"MixedEventAttendanceMode"
							]
						},
						"description": "Filter by attendance mode"
					},
					{
						"name": "username",
						"in": "query",
						"schema": {
							"type": "string"
						},
						"description": "Filter by organizer username"
					},
					{
						"name": "tags",
						"in": "query",
						"schema": {
							"type": "string"
						},
						"description": "Comma-separated list of tags to filter by"
					},
					{
						"name": "page",
						"in": "query",
						"schema": {
							"type": "integer",
							"default": 1
						}
					},
					{
						"name": "limit",
						"in": "query",
						"schema": {
							"type": "integer",
							"default": 20,
							"maximum": 100
						}
					}
				],
				"responses": {
					"200": {
						"description": "Search results",
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {
										"$ref": "#/components/schemas/Event"
									}
								}
							}
						}
					}
				}
			}
		},
		"/api/search/upcoming": {
			"get": {
				"tags": ["Search"],
				"summary": "Get upcoming events",
				"responses": {
					"200": {
						"description": "Upcoming events",
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {
										"$ref": "#/components/schemas/Event"
									}
								}
							}
						}
					}
				}
			}
		},
		"/api/search/popular": {
			"get": {
				"tags": ["Search"],
				"summary": "Get popular events",
				"responses": {
					"200": {
						"description": "Popular events",
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {
										"$ref": "#/components/schemas/Event"
									}
								}
							}
						}
					}
				}
			}
		},
		"/api/recommendations": {
			"get": {
				"tags": ["Recommendations"],
				"summary": "Get personalized event recommendations",
				"description": "Returns upcoming events scored for the authenticated user based on recent attendance, likes, followed organizers, and current engagement.",
				"parameters": [
					{
						"name": "limit",
						"in": "query",
						"description": "Maximum number of recommendations to return (1-20)",
						"schema": {
							"type": "integer",
							"minimum": 1,
							"maximum": 20,
							"default": 10
						}
					}
				],
				"responses": {
					"200": {
						"description": "List of recommended events",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"recommendations": {
											"type": "array",
											"items": {
												"type": "object",
												"properties": {
													"event": {
														"$ref": "#/components/schemas/Event"
													},
													"score": {
														"type": "number",
														"description": "Composite recommendation score"
													},
													"reasons": {
														"type": "array",
														"items": {
															"type": "string"
														}
													},
													"signals": {
														"type": "object",
														"properties": {
															"matchedTags": {
																"type": "array",
																"items": {
																	"type": "string"
																}
															},
															"followedOrganizer": {
																"type": "boolean"
															},
															"hostAffinity": {
																"type": "boolean"
															},
															"popularityScore": {
																"type": "number"
															}
														},
														"required": [
															"matchedTags",
															"followedOrganizer",
															"hostAffinity",
															"popularityScore"
														]
													}
												},
												"required": ["event", "score", "reasons", "signals"]
											}
										},
										"metadata": {
											"type": "object",
											"properties": {
												"generatedAt": {
													"type": "string",
													"format": "date-time"
												},
												"signals": {
													"type": "object",
													"properties": {
														"tags": {
															"type": "integer"
														},
														"hosts": {
															"type": "integer"
														},
														"followed": {
															"type": "integer"
														}
													}
												}
											}
										}
									},
									"required": ["recommendations"]
								}
							}
						}
					},
					"401": {
						"description": "Authentication required",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								}
							}
						}
					},
					"500": {
						"description": "Server error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								}
							}
						}
					}
				},
				"security": [
					{
						"cookieAuth": []
					}
				]
			}
		},
		"/api/search/nearby": {
			"get": {
				"tags": ["Search"],
				"summary": "Find events near a latitude/longitude",
				"parameters": [
					{
						"name": "latitude",
						"in": "query",
						"required": true,
						"schema": {
							"type": "number",
							"minimum": -90,
							"maximum": 90
						},
						"description": "Origin latitude in decimal degrees"
					},
					{
						"name": "longitude",
						"in": "query",
						"required": true,
						"schema": {
							"type": "number",
							"minimum": -180,
							"maximum": 180
						},
						"description": "Origin longitude in decimal degrees"
					},
					{
						"name": "radiusKm",
						"in": "query",
						"schema": {
							"type": "number",
							"minimum": 1,
							"maximum": 500,
							"default": 25
						},
						"description": "Search radius in kilometers"
					},
					{
						"name": "limit",
						"in": "query",
						"schema": {
							"type": "integer",
							"minimum": 1,
							"maximum": 100,
							"default": 25
						},
						"description": "Maximum events to return"
					}
				],
				"responses": {
					"200": {
						"description": "Nearby events response",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"origin": {
											"type": "object",
											"properties": {
												"latitude": {
													"type": "number",
													"format": "double"
												},
												"longitude": {
													"type": "number",
													"format": "double"
												},
												"radiusKm": {
													"type": "number",
													"format": "double"
												}
											},
											"required": ["latitude", "longitude", "radiusKm"]
										},
										"events": {
											"type": "array",
											"items": {
												"$ref": "#/components/schemas/Event"
											}
										}
									},
									"required": ["origin", "events"]
								}
							}
						}
					}
				}
			}
		},
		"/api/location/search": {
			"get": {
				"tags": ["Location"],
				"summary": "Search for a place and return coordinates",
				"parameters": [
					{
						"name": "q",
						"in": "query",
						"required": true,
						"schema": {
							"type": "string",
							"minLength": 3
						},
						"description": "Free-form place query"
					},
					{
						"name": "limit",
						"in": "query",
						"schema": {
							"type": "integer",
							"minimum": 1,
							"maximum": 10,
							"default": 5
						},
						"description": "Maximum suggestions to return"
					}
				],
				"responses": {
					"200": {
						"description": "Location suggestions",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"query": {
											"type": "string"
										},
										"results": {
											"type": "array",
											"items": {
												"$ref": "#/components/schemas/LocationSuggestion"
											}
										}
									},
									"required": ["query", "results"]
								}
							}
						}
					}
				}
			}
		},
		"/api/user-search": {
			"get": {
				"tags": ["User Search"],
				"summary": "Search for users (WebFinger)",
				"parameters": [
					{
						"name": "query",
						"in": "query",
						"required": true,
						"description": "Username or @user@domain format",
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Search results",
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {
										"$ref": "#/components/schemas/User"
									}
								}
							}
						}
					}
				}
			}
		},
		"/api/user-search/resolve": {
			"post": {
				"tags": ["User Search"],
				"summary": "Resolve remote user",
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"type": "object",
								"required": ["query"],
								"properties": {
									"query": {
										"type": "string",
										"description": "@user@domain format"
									}
								}
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "User resolved"
					}
				}
			}
		},
		"/api/user-search/profile/{username}": {
			"get": {
				"tags": ["User Search"],
				"summary": "Get user profile by username",
				"parameters": [
					{
						"name": "username",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "User profile",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/User"
								}
							}
						}
					}
				}
			}
		},
		"/api/moderation/block/user": {
			"post": {
				"tags": ["Moderation"],
				"summary": "Block a user",
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/BlockUserInput"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "User blocked"
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			}
		},
		"/api/moderation/block/user/{username}": {
			"delete": {
				"tags": ["Moderation"],
				"summary": "Unblock a user",
				"parameters": [
					{
						"name": "username",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "User unblocked"
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			}
		},
		"/api/moderation/block/users": {
			"get": {
				"tags": ["Moderation"],
				"summary": "Get blocked users",
				"responses": {
					"200": {
						"description": "List of blocked users",
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {
										"type": "string"
									}
								}
							}
						}
					}
				}
			}
		},
		"/api/moderation/block/domain": {
			"post": {
				"tags": ["Moderation"],
				"summary": "Block a domain",
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/BlockDomainInput"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Domain blocked"
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			}
		},
		"/api/moderation/block/domain/{domain}": {
			"delete": {
				"tags": ["Moderation"],
				"summary": "Unblock a domain",
				"parameters": [
					{
						"name": "domain",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Domain unblocked"
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			}
		},
		"/api/moderation/block/domains": {
			"get": {
				"tags": ["Moderation"],
				"summary": "Get blocked domains",
				"responses": {
					"200": {
						"description": "List of blocked domains",
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {
										"type": "string"
									}
								}
							}
						}
					}
				}
			}
		},
		"/api/moderation/block/check/{username}": {
			"get": {
				"tags": ["Moderation"],
				"summary": "Check if user is blocked",
				"parameters": [
					{
						"name": "username",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Block status",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"isBlocked": {
											"type": "boolean"
										}
									}
								}
							}
						}
					}
				}
			}
		},
		"/api/moderation/report": {
			"post": {
				"tags": ["Moderation"],
				"summary": "Report content or user",
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/ReportInput"
							}
						}
					}
				},
				"responses": {
					"201": {
						"description": "Report created"
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			}
		},
		"/api/moderation/reports/me": {
			"get": {
				"tags": ["Moderation"],
				"summary": "Get my reports",
				"description": "Get all reports submitted by the authenticated user",
				"responses": {
					"200": {
						"description": "List of user's reports",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"reports": {
											"type": "array",
											"items": {
												"type": "object",
												"properties": {
													"id": {
														"type": "string"
													},
													"createdAt": {
														"type": "string",
														"format": "date-time"
													},
													"updatedAt": {
														"type": "string",
														"format": "date-time"
													},
													"reporterId": {
														"type": "string"
													},
													"reportedUserId": {
														"type": "string",
														"nullable": true
													},
													"contentUrl": {
														"type": "string",
														"nullable": true
													},
													"reason": {
														"type": "string"
													},
													"category": {
														"type": "string",
														"enum": [
															"spam",
															"harassment",
															"inappropriate",
															"other"
														]
													},
													"status": {
														"type": "string",
														"enum": ["pending", "resolved", "dismissed"]
													}
												}
											}
										}
									}
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			}
		},
		"/api/moderation/reports": {
			"get": {
				"tags": ["Moderation"],
				"summary": "Get reports (admin only)",
				"responses": {
					"200": {
						"description": "List of reports",
						"content": {
							"application/json": {
								"schema": {
									"type": "array",
									"items": {
										"type": "object",
										"properties": {
											"id": {
												"type": "string"
											},
											"targetType": {
												"type": "string"
											},
											"targetId": {
												"type": "string"
											},
											"reason": {
												"type": "string"
											},
											"status": {
												"type": "string"
											}
										}
									}
								}
							}
						}
					}
				}
			}
		},
		"/api/moderation/reports/{id}": {
			"put": {
				"tags": ["Moderation"],
				"summary": "Update report status (admin only)",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"type": "object",
								"required": ["status"],
								"properties": {
									"status": {
										"type": "string",
										"enum": ["pending", "resolved", "dismissed"]
									}
								}
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Report updated"
					}
				}
			}
		},
		"/api/moderation/appeals": {
			"post": {
				"tags": ["Moderation"],
				"summary": "Create an appeal",
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/AppealInput"
							}
						}
					}
				},
				"responses": {
					"201": {
						"description": "Appeal created",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Appeal"
								}
							}
						}
					},
					"400": {
						"description": "Validation error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								}
							}
						}
					}
				}
			},
			"get": {
				"tags": ["Moderation"],
				"summary": "Get my appeals",
				"responses": {
					"200": {
						"description": "List of user appeals",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"appeals": {
											"type": "array",
											"items": {
												"$ref": "#/components/schemas/Appeal"
											}
										}
									}
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								}
							}
						}
					}
				}
			}
		},
		"/api/moderation/admin/appeals": {
			"get": {
				"tags": ["Moderation"],
				"summary": "Get all appeals (admin only)",
				"parameters": [
					{
						"name": "status",
						"in": "query",
						"required": false,
						"schema": {
							"type": "string",
							"enum": ["pending", "approved", "rejected"]
						},
						"description": "Filter by appeal status (case-insensitive, accepts lowercase)"
					},
					{
						"name": "page",
						"in": "query",
						"required": false,
						"schema": {
							"type": "integer",
							"minimum": 1,
							"default": 1
						},
						"description": "Page number"
					},
					{
						"name": "limit",
						"in": "query",
						"required": false,
						"schema": {
							"type": "integer",
							"minimum": 1,
							"maximum": 100,
							"default": 20
						},
						"description": "Items per page (max 100)"
					}
				],
				"responses": {
					"200": {
						"description": "List of appeals with pagination",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"appeals": {
											"type": "array",
											"items": {
												"$ref": "#/components/schemas/Appeal"
											}
										},
										"pagination": {
											"type": "object",
											"properties": {
												"page": {
													"type": "integer"
												},
												"limit": {
													"type": "integer"
												},
												"total": {
													"type": "integer"
												},
												"pages": {
													"type": "integer"
												}
											}
										}
									}
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden (admin only)",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								}
							}
						}
					}
				}
			}
		},
		"/api/moderation/admin/appeals/{id}": {
			"put": {
				"tags": ["Moderation"],
				"summary": "Resolve appeal (admin only)",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/AppealUpdateInput"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Appeal updated",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Appeal"
								}
							}
						}
					},
					"400": {
						"description": "Validation error",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								}
							}
						}
					},
					"403": {
						"description": "Forbidden (admin only)",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								}
							}
						}
					}
				}
			}
		},
		"/api/calendar/{id}/export.ics": {
			"get": {
				"tags": ["Calendar"],
				"summary": "Export single event as iCal",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "iCal file",
						"content": {
							"text/calendar": {
								"schema": {
									"type": "string"
								}
							}
						}
					}
				}
			}
		},
		"/api/calendar/{id}/export/google": {
			"get": {
				"tags": ["Calendar"],
				"summary": "Generate Google Calendar link for an event",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Google Calendar link",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"url": {
											"type": "string",
											"format": "uri"
										}
									},
									"required": ["url"]
								}
							}
						}
					},
					"403": {
						"description": "Forbidden"
					},
					"404": {
						"description": "Event not found"
					},
					"500": {
						"description": "Internal server error"
					}
				}
			}
		},
		"/api/calendar/user/{username}/export.ics": {
			"get": {
				"tags": ["Calendar"],
				"summary": "Export user's events as iCal",
				"parameters": [
					{
						"name": "username",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "iCal file",
						"content": {
							"text/calendar": {
								"schema": {
									"type": "string"
								}
							}
						}
					}
				}
			}
		},
		"/api/calendar/feed.ics": {
			"get": {
				"tags": ["Calendar"],
				"summary": "Export own events as iCal feed",
				"responses": {
					"200": {
						"description": "iCal file",
						"content": {
							"text/calendar": {
								"schema": {
									"type": "string"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			}
		},
		"/api/realtime/stream": {
			"get": {
				"tags": ["Realtime"],
				"summary": "Server-sent events stream",
				"description": "Subscribe to real-time updates via Server-Sent Events (SSE). Events include:\n- Event updates: `event:created`, `event:updated`, `event:deleted`\n- Attendance: `attendance:added`, `attendance:updated`, `attendance:removed`\n- Likes: `like:added`, `like:removed`\n- Comments: `comment:added`, `comment:deleted`\n- Follows: `follow:added`, `follow:removed`, `follow:accepted`, `follow:pending`, `follow:rejected`\n- Followers: `follower:added`, `follower:removed`\n- Profile: `profile:updated`\n\nAll events include a `type` field and a `data` object with event-specific information. The stream sends a `connected` event on initial connection and periodic `heartbeat` events to keep the connection alive.",
				"responses": {
					"200": {
						"description": "SSE stream",
						"content": {
							"text/event-stream": {
								"schema": {
									"type": "string",
									"description": "Server-Sent Events stream. Each event has an `event` field (event type) and a `data` field (JSON string with event data)."
								}
							}
						}
					}
				}
			}
		},
		"/api/admin/users": {
			"get": {
				"tags": ["Admin"],
				"summary": "List users",
				"description": "List all users with pagination and filtering. Admin only.",
				"parameters": [
					{
						"name": "page",
						"in": "query",
						"schema": {
							"type": "integer",
							"default": 1,
							"minimum": 1
						}
					},
					{
						"name": "limit",
						"in": "query",
						"schema": {
							"type": "integer",
							"default": 20,
							"minimum": 1,
							"maximum": 100
						}
					},
					{
						"name": "search",
						"in": "query",
						"schema": {
							"type": "string"
						},
						"description": "Search by username, name, or email"
					},
					{
						"name": "isBot",
						"in": "query",
						"schema": {
							"type": "string",
							"enum": ["true", "false"]
						},
						"description": "Filter by bot status"
					}
				],
				"responses": {
					"200": {
						"description": "User list",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/UserListResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					},
					"403": {
						"description": "Forbidden (not admin)"
					}
				}
			},
			"post": {
				"tags": ["Admin"],
				"summary": "Create user",
				"description": "Create a new user. For bot users, password is not required. For regular users, password is required. Admin only.",
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/CreateUserInput"
							}
						}
					}
				},
				"responses": {
					"201": {
						"description": "User created",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/AdminUser"
								}
							}
						}
					},
					"400": {
						"description": "Validation error or username/email already exists"
					},
					"401": {
						"description": "Unauthorized"
					},
					"403": {
						"description": "Forbidden (not admin)"
					},
					"500": {
						"description": "Internal server error"
					}
				}
			}
		},
		"/api/admin/users/{id}": {
			"get": {
				"tags": ["Admin"],
				"summary": "Get user by ID",
				"description": "Get detailed information about a specific user. Admin only.",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "User details",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/AdminUser"
								}
							}
						}
					},
					"404": {
						"description": "User not found"
					},
					"401": {
						"description": "Unauthorized"
					},
					"403": {
						"description": "Forbidden (not admin)"
					}
				}
			},
			"put": {
				"tags": ["Admin"],
				"summary": "Update user",
				"description": "Update user information. Admin only.",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/UpdateUserInput"
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "User updated",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/AdminUser"
								}
							}
						}
					},
					"400": {
						"description": "Validation error or username/email already exists"
					},
					"404": {
						"description": "User not found"
					},
					"401": {
						"description": "Unauthorized"
					},
					"403": {
						"description": "Forbidden (not admin)"
					}
				}
			},
			"delete": {
				"tags": ["Admin"],
				"summary": "Delete user",
				"description": "Delete a user. Cannot delete your own account. Admin only.",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "User deleted",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean"
										}
									}
								}
							}
						}
					},
					"400": {
						"description": "Cannot delete your own account"
					},
					"404": {
						"description": "User not found"
					},
					"401": {
						"description": "Unauthorized"
					},
					"403": {
						"description": "Forbidden (not admin)"
					}
				}
			}
		},
		"/api/admin/api-keys": {
			"get": {
				"tags": ["Admin"],
				"summary": "List API keys",
				"description": "List all API keys, optionally filtered by user. Admin only.",
				"parameters": [
					{
						"name": "userId",
						"in": "query",
						"schema": {
							"type": "string"
						},
						"description": "Filter by user ID"
					}
				],
				"responses": {
					"200": {
						"description": "API key list",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ApiKeyListResponse"
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					},
					"403": {
						"description": "Forbidden (not admin)"
					}
				}
			},
			"post": {
				"tags": ["Admin"],
				"summary": "Create API key",
				"description": "Create a new API key for a user. The full key is only returned once on creation. Admin only.",
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"$ref": "#/components/schemas/CreateApiKeyInput"
							}
						}
					}
				},
				"responses": {
					"201": {
						"description": "API key created",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/ApiKeyCreateResponse"
								}
							}
						}
					},
					"400": {
						"description": "Validation error - occurs when input validation fails (e.g., invalid tags, missing required fields, or tag normalization fails)",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								},
								"examples": {
									"tagValidationError": {
										"summary": "Tag validation error",
										"value": {
											"error": "VALIDATION_ERROR",
											"message": "Failed to process tags: ensure tags are valid strings"
										}
									},
									"schemaValidationError": {
										"summary": "Schema validation error",
										"value": {
											"error": "VALIDATION_ERROR",
											"message": "Invalid input data",
											"details": [
												{
													"code": "invalid_type",
													"expected": "string",
													"received": "number",
													"path": ["title"],
													"message": "Expected string, received number"
												}
											]
										}
									}
								}
							}
						}
					},
					"404": {
						"description": "User not found"
					},
					"401": {
						"description": "Unauthorized"
					},
					"403": {
						"description": "Forbidden (not admin)"
					}
				}
			}
		},
		"/api/admin/api-keys/{id}": {
			"delete": {
				"tags": ["Admin"],
				"summary": "Delete API key",
				"description": "Revoke an API key. Admin only.",
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"required": true,
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "API key deleted",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean"
										}
									}
								}
							}
						}
					},
					"404": {
						"description": "API key not found"
					},
					"401": {
						"description": "Unauthorized"
					},
					"403": {
						"description": "Forbidden (not admin)"
					}
				}
			}
		},
		"/api/setup/status": {
			"get": {
				"tags": ["Setup"],
				"summary": "Check if initial setup is required",
				"description": "Returns whether the instance needs initial setup (i.e., no users exist yet)",
				"security": [],
				"responses": {
					"200": {
						"description": "Setup status",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"setupRequired": {
											"type": "boolean",
											"description": "True if no users exist and setup is needed"
										}
									}
								}
							}
						}
					}
				}
			}
		},
		"/api/setup": {
			"post": {
				"tags": ["Setup"],
				"summary": "Create first admin user",
				"description": "Creates the initial admin user for a new instance. Only works when no users exist.",
				"security": [],
				"requestBody": {
					"required": true,
					"content": {
						"application/json": {
							"schema": {
								"type": "object",
								"required": ["email", "username", "name"],
								"properties": {
									"email": {
										"type": "string",
										"format": "email",
										"description": "Admin user email address"
									},
									"username": {
										"type": "string",
										"minLength": 1,
										"maxLength": 50,
										"description": "Admin username"
									},
									"name": {
										"type": "string",
										"description": "Admin display name"
									},
									"password": {
										"type": "string",
										"minLength": 8,
										"description": "Optional password. If not provided, user can only login via magic link."
									}
								}
							}
						}
					}
				},
				"responses": {
					"200": {
						"description": "Admin user created successfully",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"success": {
											"type": "boolean"
										},
										"user": {
											"type": "object",
											"properties": {
												"id": {
													"type": "string"
												},
												"email": {
													"type": "string"
												},
												"username": {
													"type": "string"
												},
												"name": {
													"type": "string"
												}
											}
										}
									}
								}
							}
						}
					},
					"400": {
						"description": "Missing required fields",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								}
							}
						}
					},
					"403": {
						"description": "Setup already completed (users exist)",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								}
							}
						}
					},
					"500": {
						"description": "Setup failed",
						"content": {
							"application/json": {
								"schema": {
									"$ref": "#/components/schemas/Error"
								}
							}
						}
					}
				}
			}
		},
		"/api/instances": {
			"get": {
				"tags": ["Instances"],
				"summary": "List known federated instances",
				"description": "Returns a list of federated instances discovered through ActivityPub activities, with statistics about connections and activity",
				"security": [
					{
						"cookieAuth": []
					},
					{
						"apiKeyAuth": []
					}
				],
				"parameters": [
					{
						"name": "limit",
						"in": "query",
						"description": "Maximum number of instances to return (max 100)",
						"schema": {
							"type": "integer",
							"minimum": 1,
							"maximum": 100,
							"default": 50
						}
					},
					{
						"name": "offset",
						"in": "query",
						"description": "Number of instances to skip for pagination",
						"schema": {
							"type": "integer",
							"minimum": 0,
							"default": 0
						}
					},
					{
						"name": "sortBy",
						"in": "query",
						"description": "Sort instances by activity, user count, or creation date",
						"schema": {
							"type": "string",
							"enum": ["activity", "users", "created"],
							"default": "activity"
						}
					}
				],
				"responses": {
					"200": {
						"description": "List of federated instances",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"instances": {
											"type": "array",
											"items": {
												"type": "object",
												"properties": {
													"id": { "type": "string" },
													"domain": { "type": "string" },
													"baseUrl": { "type": "string" },
													"software": {
														"type": "string",
														"nullable": true
													},
													"version": {
														"type": "string",
														"nullable": true
													},
													"title": { "type": "string", "nullable": true },
													"description": {
														"type": "string",
														"nullable": true
													},
													"iconUrl": {
														"type": "string",
														"nullable": true
													},
													"userCount": {
														"type": "integer",
														"nullable": true
													},
													"eventCount": {
														"type": "integer",
														"nullable": true
													},
													"lastActivityAt": {
														"type": "string",
														"format": "date-time",
														"nullable": true
													},
													"isBlocked": { "type": "boolean" },
													"stats": {
														"type": "object",
														"properties": {
															"remoteUsers": { "type": "integer" },
															"remoteEvents": { "type": "integer" },
															"localFollowing": { "type": "integer" }
														}
													}
												}
											}
										},
										"total": { "type": "integer" },
										"limit": { "type": "integer" },
										"offset": { "type": "integer" }
									}
								}
							}
						}
					},
					"401": {
						"description": "Unauthorized"
					}
				}
			}
		},
		"/api/instances/search": {
			"get": {
				"tags": ["Instances"],
				"summary": "Search for instances",
				"description": "Search known instances by domain name, title, or description",
				"security": [
					{
						"cookieAuth": []
					},
					{
						"apiKeyAuth": []
					}
				],
				"parameters": [
					{
						"name": "q",
						"in": "query",
						"required": true,
						"description": "Search query",
						"schema": {
							"type": "string"
						}
					},
					{
						"name": "limit",
						"in": "query",
						"description": "Maximum number of results (max 50)",
						"schema": {
							"type": "integer",
							"minimum": 1,
							"maximum": 50,
							"default": 20
						}
					}
				],
				"responses": {
					"200": {
						"description": "Search results",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"instances": {
											"type": "array",
											"items": {
												"type": "object",
												"properties": {
													"id": { "type": "string" },
													"domain": { "type": "string" },
													"baseUrl": { "type": "string" },
													"title": { "type": "string", "nullable": true },
													"description": {
														"type": "string",
														"nullable": true
													},
													"software": {
														"type": "string",
														"nullable": true
													},
													"version": {
														"type": "string",
														"nullable": true
													},
													"isBlocked": { "type": "boolean" }
												}
											}
										}
									}
								}
							}
						}
					},
					"400": {
						"description": "Invalid search query"
					}
				}
			}
		},
		"/api/instances/{domain}": {
			"get": {
				"tags": ["Instances"],
				"summary": "Get instance details",
				"description": "Get detailed information about a specific federated instance",
				"security": [
					{
						"cookieAuth": []
					},
					{
						"apiKeyAuth": []
					}
				],
				"parameters": [
					{
						"name": "domain",
						"in": "path",
						"required": true,
						"description": "Instance domain name",
						"schema": {
							"type": "string"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Instance details",
						"content": {
							"application/json": {
								"schema": {
									"type": "object",
									"properties": {
										"id": { "type": "string" },
										"domain": { "type": "string" },
										"baseUrl": { "type": "string" },
										"software": { "type": "string", "nullable": true },
										"version": { "type": "string", "nullable": true },
										"title": { "type": "string", "nullable": true },
										"description": { "type": "string", "nullable": true },
										"iconUrl": { "type": "string", "nullable": true },
										"contact": { "type": "string", "nullable": true },
										"userCount": { "type": "integer", "nullable": true },
										"eventCount": { "type": "integer", "nullable": true },
										"lastActivityAt": {
											"type": "string",
											"format": "date-time",
											"nullable": true
										},
										"isBlocked": { "type": "boolean" },
										"lastFetchedAt": {
											"type": "string",
											"format": "date-time",
											"nullable": true
										},
										"lastErrorAt": {
											"type": "string",
											"format": "date-time",
											"nullable": true
										},
										"lastError": { "type": "string", "nullable": true },
										"stats": {
											"type": "object",
											"properties": {
												"remoteUsers": { "type": "integer" },
												"remoteEvents": { "type": "integer" },
												"localFollowing": { "type": "integer" },
												"localFollowers": { "type": "integer" }
											}
										}
									}
								}
							}
						}
					},
					"404": {
						"description": "Instance not found"
					}
				}
			}
		}
	}
}
